(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+C6U":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return E}));var r=n("fXoL"),i=n("ofXK");const d=["move","copy","link"];function a(e){return"application/x-dnd"===e.substr(0,"application/x-dnd".length)}function s(e){if(e.dataTransfer){const t=e.dataTransfer.types;if(!t)return"Text";for(let e=0;e<t.length;e++)if("Text"===t[e]||"application/json"===t[e]||a(t[e]))return t[e]}return null}function l(e,t){return"all"===t||"uninitialized"===t?e:e.filter((function(e){return-1!==t.toLowerCase().indexOf(e)}))}function o(e,t){const n=window.getComputedStyle(t),r=parseFloat(n.paddingTop)||0,i=parseFloat(n.paddingLeft)||0,d=parseFloat(n.borderTopWidth)||0,a=parseFloat(n.borderLeftWidth)||0;return{x:e.offsetX+i+a,y:e.offsetY+r+d}}const c={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function h(){c.isDragging=!1,c.dropEffect=void 0,c.effectAllowed=void 0,c.type=void 0}function g(e,t){!0===c.isDragging&&(c.dropEffect=t),e.dataTransfer.dropEffect=t}function p(e,t){let n=l(d,e.dataTransfer?e.dataTransfer.effectAllowed:"uninitialized");return!0===c.isDragging&&(n=l(n,c.effectAllowed)),t&&(n=l(n,t)),0===n.length?"none":e.ctrlKey&&-1!==n.indexOf("copy")?"copy":e.altKey&&-1!==n.indexOf("link")?"link":n[0]}function f(e){if(!0===c.isDragging)return c.type;const t=s(e);return null!==t&&"Text"!==t&&"application/json"!==t&&t.substr("application/x-dnd".length+1)||void 0}function u(){return!1===c.isDragging}const D=c;let m=(()=>{class e{constructor(e,t,n){this.elementRef=e,this.renderer=t,this.ngZone=n,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=o,this.dndStart=new r.r,this.dndDrag=new r.r,this.dndEnd=new r.r,this.dndMoved=new r.r,this.dndCopied=new r.r,this.dndLinked=new r.r,this.dndCanceled=new r.r,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=e=>this.onDrag(e)}set dndDisableIf(e){this.draggable=!e,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&h()}onDragStart(e){if(!1===this.draggable)return!1;if(void 0!==this.dndHandle&&void 0===e._dndUsingHandle)return!1;!function(e,t,n){c.isDragging=!0,c.dropEffect="none",c.effectAllowed=t,c.type=n,e.dataTransfer.effectAllowed=t}(e,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function(e,t,n){const r="application/x-dnd"+(t.type?"-"+t.type:""),i=JSON.stringify(t);try{e.dataTransfer.setData(r,i)}catch(a){try{e.dataTransfer.setData("application/json",i)}catch(a){const t=l(d,n);e.dataTransfer.effectAllowed=t[0],e.dataTransfer.setData("Text",i)}}}(e,{data:this.dndDraggable,type:this.dndType},D.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),void 0===this.dndDragImageElementRef&&void 0===e._dndUsingHandle||function(e,t,n){const r=n(e,t)||{x:0,y:0};e.dataTransfer.setDragImage(t,r.x,r.y)}(e,this.dragImage,this.dndDragImageOffsetFunction);const t=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),t()});this.dndStart.emit(e),e.stopPropagation()}onDrag(e){this.dndDrag.emit(e)}onDragEnd(e){let t;switch(D.dropEffect){case"copy":t=this.dndCopied;break;case"link":t=this.dndLinked;break;case"move":t=this.dndMoved;break;default:t=this.dndCanceled}t.emit(e),this.dndEnd.emit(e),h(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),e.stopPropagation()}registerDragHandle(e){this.dndHandle=e}registerDragImage(e){this.dndDragImageElementRef=e}determineDragImage(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(r.o),r.Xb(r.N),r.Xb(r.H))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(e,t){1&e&&r.kc("dragstart",(function(e){return t.onDragStart(e)}))("dragend",(function(e){return t.onDragEnd(e)})),2&e&&r.Mb("draggable",t.draggable)},inputs:{dndEffectAllowed:"dndEffectAllowed",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf",dndDraggable:"dndDraggable",dndType:"dndType"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),e})(),v=(()=>{class e{constructor(e){this.elementRef=e}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(r.o))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndPlaceholderRef",""]]}),e})(),b=(()=>{class e{constructor(e,t,n){this.ngZone=e,this.elementRef=t,this.renderer=n,this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new r.r,this.dndDrop=new r.r,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=e=>this.onDragEnter(e),this.dragOverEventHandler=e=>this.onDragOver(e),this.dragLeaveEventHandler=e=>this.onDragLeave(e)}set dndDisableIf(e){this.disabled=!!e,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(e){if(!0===e._dndDropzoneActive)return void this.cleanupDragoverState();if(void 0===e._dndDropzoneActive){const t=document.elementFromPoint(e.clientX,e.clientY);this.elementRef.nativeElement.contains(t)&&(e._dndDropzoneActive=!0)}const t=f(e);!1!==this.isDropAllowed(t)&&e.preventDefault()}onDragOver(e){if(e.defaultPrevented)return;const t=f(e);if(!1===this.isDropAllowed(t))return;this.checkAndUpdatePlaceholderPosition(e);const n=p(e,this.dndEffectAllowed);"none"!==n?(e.preventDefault(),g(e,n),this.dndDragover.emit(e),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(e){try{const t=f(e);if(!1===this.isDropAllowed(t))return;const n=function(e,t){const n=s(e);return!0===t?null!==n&&a(n)?JSON.parse(e.dataTransfer.getData(n)):{}:JSON.parse(e.dataTransfer.getData(n))}(e,u());if(!1===this.isDropAllowed(n.type))return;e.preventDefault();const r=p(e);if(g(e,r),"none"===r)return;const i=this.getPlaceholderIndex();if(-1===i)return;this.dndDrop.emit({event:e,dropEffect:r,isExternal:u(),data:n.data,index:i,type:t}),e.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(e){if(void 0===e._dndDropzoneActive){const t=document.elementFromPoint(e.clientX,e.clientY);if(this.elementRef.nativeElement.contains(t))return void(e._dndDropzoneActive=!0)}this.cleanupDragoverState(),g(e,"none")}isDropAllowed(e){if(!0===this.disabled)return!1;if(!0===u()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone)return!0;if(!e)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(e)}tryGetPlaceholder(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(e){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const t=function(e,t){let n=t;for(;n.parentNode!==e;){if(!n.parentNode)return null;n=n.parentNode}return n}(this.elementRef.nativeElement,e.target);null!==t&&t!==this.placeholder&&(function(e,t,n){const r=t.getBoundingClientRect();return n?e.clientX<r.left+r.width/2:e.clientY<r.top+r.height/2}(e,t,this.dndHorizontal)?t.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t):t.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,t.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(r.H),r.Xb(r.o),r.Xb(r.N))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDropzone",""]],contentQueries:function(e,t,n){var i;1&e&&r.Qb(n,v,!0),2&e&&r.zc(i=r.lc())&&(t.dndPlaceholderRef=i.first)},hostBindings:function(e,t){1&e&&r.kc("drop",(function(e){return t.onDrop(e)}))},inputs:{dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf",dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),e})(),E=(()=>{class e{}return e.\u0275mod=r.Vb({type:e}),e.\u0275inj=r.Ub({factory:function(t){return new(t||e)},imports:[[i.c]]}),e})()},EaEm:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var r=n("mrSG"),i=n("YTAs"),d=n("dihp"),a=n("AytR"),s=n("WJ/N"),l=n("fXoL"),o=n("tk/3");let c=(()=>{class e extends s.a{constructor(e){super({apiUrl:a.a.apiUrl,entity:"sys/role-application"},e)}}return e.\u0275fac=function(t){return new(t||e)(l.hc(o.b))},e.\u0275prov=l.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=n("aceb"),g=n("+C6U"),p=n("ofXK");function f(e,t){if(1&e&&(l.dc(0,"nb-list-item",5),l.dc(1,"nb-alert",6),l.Oc(2),l.cc(),l.cc()),2&e){const e=t.$implicit;l.sc("dndDraggable",e),l.Lb(1),l.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),l.Lb(1),l.Qc(" ",e.applicationName,"")}}function u(e,t){if(1&e&&(l.dc(0,"nb-list-item",5),l.dc(1,"nb-alert",7),l.Oc(2),l.cc(),l.cc()),2&e){const e=t.$implicit;l.sc("dndDraggable",e),l.Lb(1),l.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),l.Lb(1),l.Qc(" ",e.applicationName,"")}}let D=(()=>{class e{constructor(e,t,n,r){this.applicationService=e,this.roleService=t,this.toast=n,this.roleApplicationService=r,this.columns=[],this.isRequest=!1}ngOnInit(){this.columns=[{name:"M\xe3 c\u1ed9t",prop:"applicationName"},{name:"T\xean c\u1ed9t",prop:"alias"},{name:"Nh\xf3m",prop:"applicationGroup.applicationName"},{name:"Tr\u1ea1ng th\xe1i",prop:"isEnabled"},{name:"M\xf4i tr\u01b0\u1eddng",prop:"environmentId"}],this.roleService.getOne(this.roleId,{fields:["roleName","applications"],join:[{field:"applications",select:["applicationId","applicationName","environmentId"]}]}).subscribe(e=>{this.lstDataSelected=e.applications;const t=[{field:"isEnabled",operator:"$eq",value:!0}];this.lstDataSelected.length&&t.push({field:"applicationId",operator:"$notin",value:this.lstDataSelected.map(e=>e.applicationId)}),this.applicationService.getMany({fields:["applicationName","applicationGroup","isEnabled","environmentId"],filter:t}).subscribe(e=>this.lstDataAvailable=e)})}onDrop(e,t){return Object(r.a)(this,void 0,void 0,(function*(){const n=e.data,r=[...this.lstDataAvailable],i=[...this.lstDataSelected],d="remove"===t?this.lstDataAvailable:this.lstDataSelected,a="insert"===t?this.lstDataAvailable:this.lstDataSelected,s=a.findIndex(e=>e.applicationId===n.applicationId);if(s>-1){d.push(n),a.splice(s,1);try{if(this.isRequest=!0,"remove"===t){const e=yield this.roleApplicationService.getMany({filter:[{field:"roleId",operator:"$eq",value:this.roleId},{field:"applicationId",operator:"$eq",value:n.applicationId}],limit:1}).toPromise();e&&e.length>0&&(yield this.roleApplicationService.delete(e[0].id).toPromise())}else"insert"===t&&(yield this.roleApplicationService.create({roleId:this.roleId,applicationId:n.applicationId}).toPromise())}catch(l){this.toast.danger(l&&l.message,"L\u1ed7i"),this.lstDataAvailable=r,this.lstDataSelected=i}finally{this.isRequest=!1}}}))}}return e.\u0275fac=function(t){return new(t||e)(l.Xb(i.b),l.Xb(d.b),l.Xb(h.qb),l.Xb(c))},e.\u0275cmp=l.Rb({type:e,selectors:[["ga-application"]],inputs:{roleId:"roleId"},decls:13,vars:3,consts:[[1,"row",3,"nbSpinner"],[1,"col-md-6"],["dndDropzone","",1,"dndList",3,"dndDrop"],["dndPlaceholderRef","",1,"dndPlaceholder"],[3,"dndDraggable",4,"ngFor","ngForOf"],[3,"dndDraggable"],[1,"full-width",3,"accent"],[3,"accent"]],template:function(e,t){1&e&&(l.dc(0,"div",0),l.dc(1,"div",1),l.dc(2,"nb-card-header"),l.Oc(3,"\u1ee8ng d\u1ee5ng ch\u01b0a ch\u1ecdn"),l.cc(),l.dc(4,"nb-list",2),l.kc("dndDrop",(function(e){return t.onDrop(e,"remove")})),l.Yb(5,"nb-list-item",3),l.Mc(6,f,3,3,"nb-list-item",4),l.cc(),l.cc(),l.dc(7,"div",1),l.dc(8,"nb-card-header"),l.Oc(9,"\u1ee8ng d\u1ee5ng \u0111\xe3 ch\u1ecdn"),l.cc(),l.dc(10,"nb-list",2),l.kc("dndDrop",(function(e){return t.onDrop(e,"insert")})),l.Yb(11,"nb-list-item",3),l.Mc(12,u,3,3,"nb-list-item",4),l.cc(),l.cc(),l.cc()),2&e&&(l.sc("nbSpinner",t.isRequest),l.Lb(6),l.sc("ngForOf",t.lstDataAvailable),l.Lb(6),l.sc("ngForOf",t.lstDataSelected))},directives:[h.kb,h.t,h.P,g.b,h.Q,g.d,p.t,g.a,h.j],styles:["nb-list[_ngcontent-%COMP%]{height:100%}.dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndList.dndDragover[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.dndDragging[_ngcontent-%COMP%]{border:1px solid green}.dndPlaceholder[_ngcontent-%COMP%]{min-height:72px;border:1px dashed green;background-color:rgba(0,0,0,.1)}nb-alert[_ngcontent-%COMP%]{margin:0;padding:6px 12px}"]}),e})()},ronx:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ofXK"),i=n("1ua0"),d=n("aceb"),a=n("+C6U"),s=n("fXoL");let l=(()=>{class e{}return e.\u0275mod=s.Vb({type:e}),e.\u0275inj=s.Ub({factory:function(t){return new(t||e)},imports:[[r.c,i.a,d.u,d.p,d.R,d.lb,d.k,a.c]]}),e})()},tvm6:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("ofXK"),i=n("1ua0"),d=n("aceb"),a=n("BDdu"),s=n("3Pt+"),l=n("DS98"),o=n("ExIg"),c=n("fXoL");let h=(()=>{class e{}return e.\u0275mod=c.Vb({type:e}),e.\u0275inj=c.Ub({factory:function(t){return new(t||e)},imports:[[r.c,i.a,d.k,a.a,d.w,s.g,l.a,d.H,d.p,d.sb,d.lb,d.u,o.e]]}),e})()}}]);