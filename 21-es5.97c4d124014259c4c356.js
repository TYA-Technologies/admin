!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var c=0;c<t.length;c++){var n=t[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,c,n){return c&&t(e.prototype,c),n&&t(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{U3uG:function(t,n,i){"use strict";i.r(n),i.d(n,"RoleModule",(function(){return le}));var l=i("ofXK"),a=i("mrSG"),o=i("dihp"),r=i("advQ"),u=i("ExIg"),d=i("cp0P"),s=i("nYR2"),b=i("fXoL"),m=i("tyNb"),f=i("aceb"),h=i("3Pt+"),g=i("NL+w"),p=i("wnGv"),v=i("GwA9"),y=["table"],k=["tplCellStatus"],E=["tplCellSum"],M=["tplCellRoleParent"];function C(e,t){if(1&e){var c=b.ec();b.dc(0,"div"),b.dc(1,"nb-card"),b.dc(2,"nb-card-header"),b.Oc(3,"Ch\u1ec9nh s\u1eeda"),b.cc(),b.dc(4,"nb-card-body"),b.dc(5,"div",0),b.dc(6,"div",18),b.dc(7,"label",4),b.dc(8,"strong"),b.Oc(9,"Nh\xf3m quy\u1ec1n"),b.cc(),b.cc(),b.dc(10,"ga-tree",5,6),b.kc("itemSelectedChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.roleParent=e})),b.cc(),b.cc(),b.dc(12,"div",19),b.dc(13,"nb-radio-group",20),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.status=e})),b.dc(14,"nb-radio",21),b.dc(15,"nb-alert",22),b.Oc(16," M\u1edf "),b.cc(),b.cc(),b.dc(17,"nb-radio",21),b.dc(18,"nb-alert",23),b.Oc(19," Kh\xf3a "),b.cc(),b.cc(),b.dc(20,"nb-radio",21),b.dc(21,"nb-alert",24),b.Oc(22," \u1ea8n "),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.dc(23,"nb-card-footer",25),b.dc(24,"button",26),b.kc("click",(function(){return b.Dc(c),b.mc().cancelMulEdit()})),b.Oc(25," H\u1ee7y "),b.cc(),b.dc(26,"button",27),b.kc("click",(function(){return b.Dc(c),b.mc().mulEditSubmit()})),b.Oc(27," C\u1eadp nh\u1eadt "),b.cc(),b.cc(),b.cc(),b.cc()}if(2&e){var n=b.mc();b.Lb(10),b.sc("displayRefresh",!0)("config",n.treeConfig)("itemSelected",n.mulEditEntity.roleParent),b.Lb(3),b.sc("ngModel",n.mulEditEntity.status),b.Lb(1),b.sc("value",n.RoleStatusEnum.Open),b.Lb(3),b.sc("value",n.RoleStatusEnum.Lock),b.Lb(3),b.sc("value",n.RoleStatusEnum.Hide),b.Lb(6),b.sc("disabled",n.isMulEditingReq)("nbSpinner",n.isMulEditingReq)}}function w(e,t){if(1&e&&(b.dc(0,"nb-alert",30),b.Oc(1),b.cc()),2&e){var c=b.mc().value,n=b.mc();b.sc("status",c===n.RoleStatusEnum.Hide?"default":c===n.RoleStatusEnum.Lock?"danger":c===n.RoleStatusEnum.Open?"success":""),b.Lb(1),b.Qc(" ",c===n.RoleStatusEnum.Hide?"\u1ea8n":c===n.RoleStatusEnum.Lock?"Kh\xf3a":c===n.RoleStatusEnum.Open?"M\u1edf":""," ")}}function S(e,t){if(1&e){var c=b.ec();b.dc(0,"nb-select",20),b.kc("ngModelChange",(function(e){b.Dc(c);var t=b.mc();return t.rowEdit[t.column.prop]=e})),b.dc(1,"nb-option",21),b.Oc(2,"M\u1edf"),b.cc(),b.dc(3,"nb-option",21),b.Oc(4,"Kh\xf3a"),b.cc(),b.dc(5,"nb-option",21),b.Oc(6,"\u1ea8n"),b.cc(),b.cc()}if(2&e){var n=b.mc(),i=n.rowEdit,l=n.column,a=b.mc();b.sc("ngModel",i[l.prop]),b.Lb(1),b.sc("value",a.RoleStatusEnum.Open),b.Lb(2),b.sc("value",a.RoleStatusEnum.Lock),b.Lb(2),b.sc("value",a.RoleStatusEnum.Hide)}}function I(e,t){if(1&e&&(b.Mc(0,w,2,2,"nb-alert",28),b.Mc(1,S,7,4,"nb-select",29)),2&e){var c=t.isEdit;b.sc("ngIf",!c),b.Lb(1),b.sc("ngIf",c)}}function L(e,t){1&e&&b.Oc(0),2&e&&b.Qc(" ",t.value.length,"\n")}function O(e,t){if(1&e&&(b.bc(0),b.Oc(1),b.ac()),2&e){var c=b.mc().value;b.Lb(1),b.Qc(" ",c.roleName," ")}}function D(e,t){if(1&e){var c=b.ec();b.bc(0),b.dc(1,"ga-tree",31),b.kc("itemSelectedChange",(function(e){return b.Dc(c),b.mc().rowEdit.roleParent=e})),b.cc(),b.ac()}if(2&e){var n=b.mc(2);b.Lb(1),b.sc("config",n.treeConfig)}}function x(e,t){if(1&e&&(b.Mc(0,O,2,1,"ng-container",12),b.Mc(1,D,2,1,"ng-container",12)),2&e){var c=t.isEdit;b.sc("ngIf",!c),b.Lb(1),b.sc("ngIf",c)}}var R,T,N=((R=function(){function t(c,n,i,l){var a=this;e(this,t),this.roleService=c,this.router=n,this.activatedRoute=i,this.toast=l,this.RoleStatusEnum=r.a,this.ColumnMode=u.a,this.columns=[],this.bulkActions=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"},{name:"delete",title:"X\xf3a"}],this.actions=[{name:"quick-edit"},{name:"application",icon:'<i class="fab fa-windows"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp \xfang d\u1ee5ng",click:function(e){return a.viewApplication(e)}},{name:"layer",icon:'<i class="fas fa-layer-group"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp l\u1edbp d\u1eef li\u1ec7u",click:function(e){return a.viewLayer(e)}},{name:"delete"}],this.datatableService={service:this.roleService,primaryField:"roleId",builder:this.getDataServiceBuilder.bind(this)},this.filterSelectConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldGroup:"roleParentId"},this.entityAdd={},this.isAdding=!1,this.treeConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldParent:"roleParentId"},this.filterEntity={roleName:"",roleParentId:null},this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}return c(t,[{key:"ngOnInit",value:function(){this.columns=[{name:"T\xean",prop:"roleName",flexGrow:1,type:"string"},{name:"Nh\xf3m",prop:"roleParent",minWidth:270,cellTemplate:this.tplCellRoleParent},{name:"T\xe0i kho\u1ea3n",prop:"users",width:70,cellTemplate:this.tplCellSum},{name:"Tr\u1ea1ng th\xe1i",prop:"status",maxWidth:170,type:"boolean",cellTemplate:this.tplCellStatus}]}},{key:"getDataServiceBuilder",value:function(e){e.select(["roleName","roleParent","users","status"]),e.setJoin([{field:"roleParent",select:["roleName"]},{field:"users",select:["userId"]}]);var t=this.filterEntity,c=t.roleName,n=t.roleParentId;n&&e.setFilter({field:"roleParentId",operator:"$eq",value:n}),c&&e.setFilter({field:"roleName",operator:"$cont",value:c})}},{key:"viewApplication",value:function(e){this.router.navigate([e.roleId,"application"],{relativeTo:this.activatedRoute})}},{key:"viewLayer",value:function(e){this.router.navigate([e.roleId,"layer"],{relativeTo:this.activatedRoute})}},{key:"buttonNewClick",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.entityAdd.roleName){e.next=17;break}return e.prev=1,this.isAdding=!0,e.next=5,this.roleService.create(this.entityAdd).toPromise();case 5:this.toast.success("Th\xeam m\u1edbi th\xe0nh c\xf4ng","Th\xf4ng b\xe1o"),this.table.loadData(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.toast.danger(e.t0&&e.t0.message,"L\u1ed7i");case 12:return e.prev=12,this.isAdding=!1,e.finish(12);case 15:e.next=18;break;case 17:this.toast.warning("Nh\u1eadp t\xean quy\u1ec1n","L\u1ed7i nh\u1eadp li\u1ec7u");case 18:case"end":return e.stop()}}),e,this,[[1,9,12,15]])})))}},{key:"filter",value:function(){this.table.loadData()}},{key:"selectedItem",value:function(e){this.tblItemSelected=e.selected}},{key:"bulkClick",value:function(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={})}},{key:"mulEditSubmit",value:function(){var e=this;this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(d.a)(this.tblItemSelected.map((function(t){return e.roleService.patch(t.roleId,{roleParent:e.mulEditEntity.roleParent,status:e.mulEditEntity.status})}))).pipe(Object(s.a)((function(){e.isMulEditingReq=!1,delete e.subcriberMulEdit,delete e.mulEditEntity}))).subscribe((function(t){e.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),e.table.loadData()}),(function(t){e.toast.danger(t&&t.message,"L\u1ed7i")})))}},{key:"cancelMulEdit",value:function(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}},{key:"isMulEdit",get:function(){return Boolean(this.mulEditEntity)}}]),t}()).\u0275fac=function(e){return new(e||R)(b.Xb(o.b),b.Xb(m.c),b.Xb(m.a),b.Xb(f.qb))},R.\u0275cmp=b.Rb({type:R,selectors:[["ga-role"]],viewQuery:function(e,t){var c;1&e&&(b.Jc(y,!0),b.Jc(k,!0),b.Jc(E,!0),b.Jc(M,!0)),2&e&&(b.zc(c=b.lc())&&(t.table=c.first),b.zc(c=b.lc())&&(t.tplCellStatus=c.first),b.zc(c=b.lc())&&(t.tplCellSum=c.first),b.zc(c=b.lc())&&(t.tplCellRoleParent=c.first))},decls:39,vars:19,consts:[[1,"row"],[1,"col-md-12"],[1,"col-md-4"],["nbInput","","fieldSize","small","fullWidth","","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["for","",1,"form-input"],["fullWidth","",1,"form-input",3,"displayRefresh","config","itemSelected","itemSelectedChange"],["tree",""],["nbButton","","size","small",3,"disabled","nbSpinner","click"],[1,"col-md-8"],["placeholder","Nh\xf3m quy\u1ec1n",1,"form-input",3,"config","value","valueChange"],["nbInput","","fieldSize","small","type","text","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["nbButton","","size","small","outline","","status","primary",1,"form-input",3,"click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped","mt-2",3,"externalPaging","columns","datatableService","actions","columnMode","limit","bulkActions","rowHeight","selected","select","bulkClick"],["table",""],["tplCellStatus",""],["tplCellSum",""],["tplCellRoleParent",""],[1,"col-md-9","col-xs-12"],[1,"col-md-3","col-xs-12"],[3,"ngModel","ngModelChange"],[3,"value"],["gaTag","","status","success"],["gaTag","","status","danger"],["gaTag","","status","default"],[1,"d-flex","justify-content-between"],["status","danger","nbButton","","size","small","outline","",3,"click"],["nbButton","","size","small","status","primary",3,"disabled","nbSpinner","click"],["gaTag","",3,"status",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["gaTag","",3,"status"],[1,"tree",3,"config","itemSelectedChange"]],template:function(e,t){if(1&e){var c=b.ec();b.dc(0,"div",0),b.dc(1,"div",1),b.dc(2,"nb-card"),b.dc(3,"nb-card-header"),b.Oc(4,"Quy\u1ec1n"),b.cc(),b.dc(5,"nb-card-body"),b.dc(6,"div",0),b.dc(7,"div",2),b.dc(8,"nb-card"),b.dc(9,"nb-card-header"),b.Oc(10,"Th\xeam m\u1edbi"),b.cc(),b.dc(11,"nb-card-body"),b.dc(12,"input",3),b.kc("ngModelChange",(function(e){return t.entityAdd.roleName=e})),b.cc(),b.dc(13,"label",4),b.dc(14,"strong"),b.Oc(15,"Nh\xf3m quy\u1ec1n"),b.cc(),b.cc(),b.dc(16,"ga-tree",5,6),b.kc("itemSelectedChange",(function(e){return t.entityAdd.roleParent=e})),b.cc(),b.cc(),b.dc(18,"nb-card-footer"),b.dc(19,"button",7),b.kc("click",(function(){b.Dc(c);var e=b.Ac(17);return t.buttonNewClick(),e.loadData()})),b.Oc(20," Th\xeam m\u1edbi "),b.cc(),b.cc(),b.cc(),b.cc(),b.dc(21,"div",8),b.dc(22,"div",0),b.dc(23,"div",1),b.dc(24,"div"),b.dc(25,"ga-select",9),b.kc("valueChange",(function(e){return t.filterEntity.roleParentId=e})),b.cc(),b.dc(26,"input",10),b.kc("ngModelChange",(function(e){return t.filterEntity.roleName=e})),b.cc(),b.dc(27,"button",11),b.kc("click",(function(){return t.filter()})),b.Oc(28," L\u1ecdc "),b.cc(),b.Mc(29,C,28,9,"div",12),b.cc(),b.dc(30,"ngn-datatable",13,14),b.kc("select",(function(e){return t.selectedItem(e)}))("bulkClick",(function(e){return t.bulkClick(e)})),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.cc(),b.Mc(32,I,2,2,"ng-template",null,15,b.Nc),b.Mc(34,L,1,1,"ng-template",null,16,b.Nc),b.Mc(36,x,2,2,"ng-template",null,17,b.Nc),b.Yb(38,"router-outlet")}2&e&&(b.Lb(12),b.sc("ngModel",t.entityAdd.roleName),b.Lb(4),b.sc("displayRefresh",!0)("config",t.treeConfig)("itemSelected",t.entityAdd.roleParent),b.Lb(3),b.sc("disabled",t.isMulEdit)("nbSpinner",t.isAdding),b.Lb(6),b.sc("config",t.filterSelectConfig)("value",t.filterEntity.roleParentId),b.Lb(1),b.sc("ngModel",t.filterEntity.roleName),b.Lb(3),b.sc("ngIf",t.isMulEdit),b.Lb(1),b.sc("externalPaging",!0)("columns",t.columns)("datatableService",t.datatableService)("actions",t.actions)("columnMode",t.ColumnMode.force)("limit",10)("bulkActions",t.bulkActions)("rowHeight","auto")("selected",t.tblItemSelected))},directives:[f.r,f.t,f.q,f.G,h.b,h.j,h.m,g.a,f.s,f.o,f.kb,p.a,l.u,u.d,m.h,f.bb,f.ab,f.j,v.a,f.fb,f.W],styles:[".body[_ngcontent-%COMP%]{width:240px;height:70vh}.tree[_ngcontent-%COMP%]{max-height:240px;overflow:auto}.card-filter[_ngcontent-%COMP%]{max-height:300px}"]}),R),P=i("BDdu"),q=i("1ua0"),A=i("ronx"),G=i("6n0X"),B=i("DS98"),z=i("tvm6"),X=i("jF+W"),V=i("EaEm"),j=["dlg"],F=((T=function(){function t(c,n){e(this,t),this.router=c,this.activatedRoute=n,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}return c(t,[{key:"ngOnInit",value:function(){this.roleId=this.activatedRoute.snapshot.paramMap.get("roleId")}},{key:"closeViewField",value:function(){this.router.navigate(["../.."],{relativeTo:this.activatedRoute})}},{key:"ngOnDestroy",value:function(){this.dlg.close()}}]),t}()).\u0275fac=function(e){return new(e||T)(b.Xb(m.c),b.Xb(m.a))},T.\u0275cmp=b.Rb({type:T,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&b.Jc(j,!0),2&e&&b.zc(c=b.lc())&&(t.dlg=c.first)},decls:9,vars:9,consts:[[3,"open","userConfig"],["dlg",""],[3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){1&e&&(b.dc(0,"core-dialog",0,1),b.dc(2,"core-dialog-header"),b.Oc(3,"\u1ee8ng d\u1ee5ng"),b.cc(),b.dc(4,"core-dialog-body"),b.Yb(5,"ga-application",2),b.cc(),b.dc(6,"core-dialog-footer"),b.dc(7,"button",3),b.kc("click",(function(){return t.closeViewField()})),b.Oc(8,"\u0110\xf3ng"),b.cc(),b.cc(),b.cc()),2&e&&(b.sc("open",!0)("userConfig",t.userConfig),b.Lb(4),b.Kc("width",80,"vw")("max-height",70,"vh")("overflow","auto"),b.Lb(1),b.sc("roleId",t.roleId))},directives:[X.b,X.d,X.a,V.a,X.c,f.o],encapsulation:2}),T),H=i("bANk"),J=i("CjdU"),Q=["table"];function W(e,t){if(1&e){var c=b.ec();b.dc(0,"div"),b.dc(1,"nb-card",23),b.dc(2,"nb-card-header"),b.Oc(3,"Ch\u1ec9nh s\u1eeda"),b.cc(),b.dc(4,"nb-card-body"),b.dc(5,"div",24),b.dc(6,"nb-checkbox",25),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.isView=e})),b.Oc(7,"\u0110\u01b0\u1ee3c ph\xe9p xem"),b.cc(),b.dc(8,"nb-checkbox",25),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.isCreate=e})),b.Oc(9,"\u0110\u01b0\u1ee3c ph\xe9p t\u1ea1o"),b.cc(),b.dc(10,"nb-checkbox",25),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.isEdit=e})),b.Oc(11,"\u0110\u01b0\u1ee3c ph\xe9p ch\u1ec9nh s\u1eeda"),b.cc(),b.dc(12,"nb-checkbox",25),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.isDelete=e})),b.Oc(13,"\u0110\u01b0\u1ee3c ph\xe9p x\xf3a"),b.cc(),b.cc(),b.dc(14,"div",24),b.dc(15,"input",26),b.kc("ngModelChange",(function(e){return b.Dc(c),b.mc().mulEditEntity.definition=e})),b.cc(),b.cc(),b.cc(),b.dc(16,"nb-card-footer",27),b.dc(17,"button",28),b.kc("click",(function(){return b.Dc(c),b.mc().cancelMulEdit()})),b.Oc(18,"H\u1ee7y"),b.cc(),b.dc(19,"button",29),b.kc("click",(function(){return b.Dc(c),b.mc().mulEditSubmit()})),b.Oc(20,"L\u01b0u"),b.cc(),b.cc(),b.cc(),b.cc()}if(2&e){var n=b.mc();b.Lb(6),b.sc("ngModel",n.mulEditEntity.isView),b.Lb(2),b.sc("ngModel",n.mulEditEntity.isCreate),b.Lb(2),b.sc("ngModel",n.mulEditEntity.isEdit),b.Lb(2),b.sc("ngModel",n.mulEditEntity.isDelete),b.Lb(3),b.sc("ngModel",n.mulEditEntity.definition)}}function Y(e,t){if(1&e){var c=b.ec();b.dc(0,"input",30),b.kc("ngModelChange",(function(e){return b.Dc(c),t.row[t.column.prop]=e}))("change",(function(){b.Dc(c);var e=t.column,n=t.row;return b.mc().updateCellValue(e.prop,n)})),b.cc()}2&e&&b.sc("ngModel",t.row[t.column.prop])}function K(e,t){if(1&e){var c=b.ec();b.dc(0,"input",30),b.kc("ngModelChange",(function(e){return b.Dc(c),t.row[t.column.prop]=e}))("change",(function(){b.Dc(c);var e=t.column,n=t.row;return b.mc().updateCellValue(e.prop,n)})),b.cc()}2&e&&b.sc("ngModel",t.row[t.column.prop])}function $(e,t){if(1&e){var c=b.ec();b.dc(0,"input",30),b.kc("ngModelChange",(function(e){return b.Dc(c),t.row[t.column.prop]=e}))("change",(function(){b.Dc(c);var e=t.column,n=t.row;return b.mc().updateCellValue(e.prop,n)})),b.cc()}2&e&&b.sc("ngModel",t.row[t.column.prop])}function U(e,t){if(1&e){var c=b.ec();b.dc(0,"input",30),b.kc("ngModelChange",(function(e){return b.Dc(c),t.row[t.column.prop]=e}))("change",(function(){b.Dc(c);var e=t.column,n=t.row;return b.mc().updateCellValue(e.prop,n)})),b.cc()}2&e&&b.sc("ngModel",t.row[t.column.prop])}function _(e,t){if(1&e){var c=b.ec();b.dc(0,"nb-checkbox",31),b.kc("ngModelChange",(function(e){return b.Dc(c),t.row[t.column.prop]=e}))("ngModelChange",(function(){b.Dc(c);var e=t.column,n=t.row;return b.mc().updateCellValue(e.prop,n)})),b.cc()}2&e&&b.sc("ngModel",t.row[t.column.prop])}var Z,ee,te,ce=((Z=function(){function t(c,n,i,l,a){e(this,t),this.layerService=c,this.datasetService=n,this.roleLayerService=i,this.toast=l,this.roleService=a,this.ColumnMode=u.a,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1,hasScroll:!0},this.lstDatasetId=[],this.configSelDts={service:this.datasetService,fieldName:"datasetName",fieldValue:"datasetId"},this.bulks=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"}],this.isSync=!1,this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}return c(t,[{key:"ngOnInit",value:function(){this.datatableService={service:this.roleLayerService,primaryField:"id",builder:this.getBuilder.bind(this)}}},{key:"getBuilder",value:function(e){e.select(["roleId","isView","isCreate","isDelete","isEdit","definition","outFields","queryFields","updateFields"]),e.setJoin([{field:"layer",select:["layerName","datasetId"]}]),e.setFilter([{field:"roleId",operator:"$eq",value:this.roleId},{field:"layer.datasetId",operator:"$in",value:this.lstDatasetId}])}},{key:"selectedItem",value:function(e){this.tblItemSelected=e.selected}},{key:"bulkClick",value:function(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={isEdit:!0,isCreate:!0,isDelete:!0,isView:!0,outFields:null,queryFields:null,updateFields:null})}},{key:"mulEditSubmit",value:function(){var e=this;this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(d.a)(this.tblItemSelected.map((function(t){return e.roleLayerService.patch(t.id,e.mulEditEntity)}))).pipe(Object(s.a)((function(){e.isMulEditingReq=!1,delete e.subcriberMulEdit,delete e.mulEditEntity}))).subscribe((function(t){e.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),e.table.loadData()}),(function(t){e.toast.danger(t&&t.message,"L\u1ed7i")})))}},{key:"cancelMulEdit",value:function(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}},{key:"sync",value:function(){var e=this;this.roleId&&(this.lstDatasetId?(this.isSync=!0,this.roleService.syncLayers({roleId:this.roleId,lstDatasetId:this.lstDatasetId}).pipe(Object(s.a)((function(){return e.isSync=!1}))).subscribe((function(t){e.toast.success("\u0110\u1ed3ng b\u1ed9 th\xe0nh c\xf4ng "+t.length,"Th\xe0nh c\xf4ng"),e.table.loadData()}),(function(t){return e.toast.danger(t||"C\xf3 l\u1ed7i x\u1ea3y ra")}))):this.toast.warning("Vui l\xf2ng ch\u1ecdn dataset","Th\xf4ng b\xe1o"))}},{key:"updateCellValue",value:function(e,t){var c,n,i;this.roleLayerService.patch(t.id,(c={},n=e,i=t[e],n in c?Object.defineProperty(c,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):c[n]=i,c)).subscribe()}},{key:"isMulEdit",get:function(){return Boolean(this.mulEditEntity)}}]),t}()).\u0275fac=function(e){return new(e||Z)(b.Xb(H.a),b.Xb(J.a),b.Xb(o.a),b.Xb(f.qb),b.Xb(o.b))},Z.\u0275cmp=b.Rb({type:Z,selectors:[["ga-layer"]],viewQuery:function(e,t){var c;1&e&&b.Sc(Q,!0),2&e&&b.zc(c=b.lc())&&(t.table=c.first)},inputs:{roleId:"roleId"},decls:33,vars:25,consts:[[1,"row"],[1,"col-md-12"],["fullWidth","","placeholder","Dataset",1,"w-100",3,"multiple","config","value","valueChange"],["selectDts",""],[1,"col-md-12","d-flex","justify-content-end","mt-2"],["nbButton","","size","small","outline","","ghost","","status","danger",3,"click"],["nbButton","","size","small","outline","","ghost","",3,"click"],["nbButton","","size","small","outline","",3,"click"],["nbButton","","outline","","status","danger","nbTooltip","T\u1ea3i l\u1edbp d\u1eef li\u1ec7u t\u1eeb h\u1ec7 th\u1ed1ng \u0111\u1ec3 c\u1ea5p quy\u1ec1n truy c\u1eadp",3,"disabled","nbSpinner","click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped",3,"externalPaging","limit","datatableService","columnMode","bulkActions","selected","bulkClick","select"],["table",""],["name","T\xean","prop","layer.layerName",3,"flexGrow"],["name","Xem","prop","isView",3,"flexGrow","cellTemplate"],["name","T\u1ea1o","prop","isCreate",3,"flexGrow","cellTemplate"],["name","X\xf3a","prop","isDelete",3,"flexGrow","cellTemplate"],["name","S\u1eeda","prop","isEdit",3,"flexGrow","cellTemplate"],["name","L\u1ec7nh truy v\u1ea5n","prop","definition",3,"flexGrow"],["ngn-datatable-cell-template",""],["name","Thu\u1ed9c t\xednh hi\u1ec3n th\u1ecb","prop","outFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh t\xecm ki\u1ebfm","prop","queryFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh c\u1eadp nh\u1eadt","prop","updateFields",3,"flexGrow"],["tplCellStatus",""],[1,"mt-2"],[1,"row","col-md-12"],[1,"form-input",3,"ngModel","ngModelChange"],["type","text","nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["nbButton","","size","small","ghost","",3,"click"],["nbButton","","size","small",3,"click"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e){var c=b.ec();b.dc(0,"div",0),b.dc(1,"div",1),b.dc(2,"ga-select",2,3),b.kc("valueChange",(function(e){return t.lstDatasetId=e})),b.cc(),b.cc(),b.dc(4,"div",4),b.dc(5,"button",5),b.kc("click",(function(){return t.lstDatasetId=[]})),b.Oc(6,"H\u1ee7y ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),b.cc(),b.dc(7,"button",6),b.kc("click",(function(){return b.Dc(c),b.Ac(3).selectAll()})),b.Oc(8,"Ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),b.cc(),b.dc(9,"button",7),b.kc("click",(function(){return b.Dc(c),b.Ac(17).loadData()})),b.Oc(10,"L\u1ecdc"),b.cc(),b.cc(),b.dc(11,"div",1),b.dc(12,"div"),b.dc(13,"button",8),b.kc("click",(function(){return t.sync()})),b.Oc(14," \u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u "),b.cc(),b.cc(),b.Mc(15,W,21,5,"div",9),b.dc(16,"ngn-datatable",10,11),b.kc("bulkClick",(function(e){return t.bulkClick(e)}))("select",(function(e){return t.selectedItem(e)})),b.Yb(18,"ngn-datatable-column",12),b.Yb(19,"ngn-datatable-column",13),b.Yb(20,"ngn-datatable-column",14),b.Yb(21,"ngn-datatable-column",15),b.Yb(22,"ngn-datatable-column",16),b.dc(23,"ngn-datatable-column",17),b.Mc(24,Y,1,1,"ng-template",18),b.cc(),b.dc(25,"ngn-datatable-column",19),b.Mc(26,K,1,1,"ng-template",18),b.cc(),b.dc(27,"ngn-datatable-column",20),b.Mc(28,$,1,1,"ng-template",18),b.cc(),b.dc(29,"ngn-datatable-column",21),b.Mc(30,U,1,1,"ng-template",18),b.cc(),b.cc(),b.cc(),b.cc(),b.Mc(31,_,1,1,"ng-template",null,22,b.Nc)}if(2&e){var n=b.Ac(32);b.Lb(2),b.sc("multiple",!0)("config",t.configSelDts)("value",t.lstDatasetId),b.Lb(11),b.sc("disabled",0===t.lstDatasetId.length||t.isSync)("nbSpinner",t.isSync),b.Lb(2),b.sc("ngIf",t.isMulEdit),b.Lb(1),b.sc("externalPaging",!0)("limit",255)("datatableService",t.datatableService)("columnMode",t.ColumnMode.flex)("bulkActions",t.bulks)("selected",t.tblItemSelected),b.Lb(2),b.sc("flexGrow",2),b.Lb(1),b.sc("flexGrow",1)("cellTemplate",n),b.Lb(1),b.sc("flexGrow",1)("cellTemplate",n),b.Lb(1),b.sc("flexGrow",1)("cellTemplate",n),b.Lb(1),b.sc("flexGrow",1)("cellTemplate",n),b.Lb(1),b.sc("flexGrow",2),b.Lb(2),b.sc("flexGrow",4),b.Lb(2),b.sc("flexGrow",4),b.Lb(2),b.sc("flexGrow",4)}},directives:[p.a,f.o,f.rb,f.kb,l.u,u.d,u.c,u.b,f.r,f.t,f.q,f.v,h.j,h.m,f.G,h.b,f.s],styles:[""]}),Z),ne=["dlg"],ie=((te=function(){function t(c,n){e(this,t),this.router=c,this.route=n,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}return c(t,[{key:"ngOnInit",value:function(){this.roleId=this.route.snapshot.paramMap.get("roleId")}},{key:"exit",value:function(){this.router.navigate(["../.."],{relativeTo:this.route})}},{key:"ngOnDestroy",value:function(){this.dlg.close()}}]),t}()).\u0275fac=function(e){return new(e||te)(b.Xb(m.c),b.Xb(m.a))},te.\u0275cmp=b.Rb({type:te,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&b.Jc(ne,!0),2&e&&b.zc(c=b.lc())&&(t.dlg=c.first)},decls:9,vars:4,consts:[[3,"open","userConfig","width"],["dlg",""],[1,"w-100",3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){if(1&e){var c=b.ec();b.dc(0,"core-dialog",0,1),b.dc(2,"core-dialog-header"),b.Oc(3,"L\u1edbp d\u1eef li\u1ec7u"),b.cc(),b.dc(4,"core-dialog-body"),b.Yb(5,"ga-layer",2),b.cc(),b.dc(6,"core-dialog-footer"),b.dc(7,"button",3),b.kc("click",(function(){return b.Dc(c),b.Ac(1).close(),t.exit()})),b.Oc(8,"\u0110\xf3ng"),b.cc(),b.cc(),b.cc()}2&e&&(b.sc("open",!0)("userConfig",t.userConfig)("width","100vw"),b.Lb(5),b.sc("roleId",t.roleId))},directives:[X.b,X.d,X.a,ce,X.c,f.o],encapsulation:2}),te),le=((ee=function t(){e(this,t)}).\u0275mod=b.Vb({type:ee}),ee.\u0275inj=b.Ub({factory:function(e){return new(e||ee)},imports:[[l.c,f.f,f.B,f.u,f.H,f.k,f.p,q.a,h.g,f.gb,G.a,f.lb,P.a,f.w,A.a,B.a,f.cb,z.a,u.e,m.g.forChild([{path:"",component:N,children:[{path:":roleId/application",component:F},{path:":roleId/layer",component:ie}]}])]]}),ee)}}])}();