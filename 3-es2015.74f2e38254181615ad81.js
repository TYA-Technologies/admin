(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+C6U":function(e,n,t){"use strict";t.d(n,"a",(function(){return m})),t.d(n,"d",(function(){return v})),t.d(n,"b",(function(){return b})),t.d(n,"c",(function(){return E}));var r=t("fXoL"),d=t("ofXK");const i=["move","copy","link"];function a(e){return"application/x-dnd"===e.substr(0,"application/x-dnd".length)}function s(e){if(e.dataTransfer){const n=e.dataTransfer.types;if(!n)return"Text";for(let e=0;e<n.length;e++)if("Text"===n[e]||"application/json"===n[e]||a(n[e]))return n[e]}return null}function l(e,n){return"all"===n||"uninitialized"===n?e:e.filter((function(e){return-1!==n.toLowerCase().indexOf(e)}))}function o(e,n){const t=window.getComputedStyle(n),r=parseFloat(t.paddingTop)||0,d=parseFloat(t.paddingLeft)||0,i=parseFloat(t.borderTopWidth)||0,a=parseFloat(t.borderLeftWidth)||0;return{x:e.offsetX+d+a,y:e.offsetY+r+i}}const c={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function h(){c.isDragging=!1,c.dropEffect=void 0,c.effectAllowed=void 0,c.type=void 0}function g(e,n){!0===c.isDragging&&(c.dropEffect=n),e.dataTransfer.dropEffect=n}function f(e,n){let t=l(i,e.dataTransfer?e.dataTransfer.effectAllowed:"uninitialized");return!0===c.isDragging&&(t=l(t,c.effectAllowed)),n&&(t=l(t,n)),0===t.length?"none":e.ctrlKey&&-1!==t.indexOf("copy")?"copy":e.altKey&&-1!==t.indexOf("link")?"link":t[0]}function p(e){if(!0===c.isDragging)return c.type;const n=s(e);return null!==n&&"Text"!==n&&"application/json"!==n&&n.substr("application/x-dnd".length+1)||void 0}function u(){return!1===c.isDragging}const D=c;let m=(()=>{class e{constructor(e,n,t){this.elementRef=e,this.renderer=n,this.ngZone=t,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=o,this.dndStart=new r.r,this.dndDrag=new r.r,this.dndEnd=new r.r,this.dndMoved=new r.r,this.dndCopied=new r.r,this.dndLinked=new r.r,this.dndCanceled=new r.r,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=e=>this.onDrag(e)}set dndDisableIf(e){this.draggable=!e,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&h()}onDragStart(e){if(!1===this.draggable)return!1;if(void 0!==this.dndHandle&&void 0===e._dndUsingHandle)return!1;!function(e,n,t){c.isDragging=!0,c.dropEffect="none",c.effectAllowed=n,c.type=t,e.dataTransfer.effectAllowed=n}(e,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function(e,n,t){const r="application/x-dnd"+(n.type?"-"+n.type:""),d=JSON.stringify(n);try{e.dataTransfer.setData(r,d)}catch(a){try{e.dataTransfer.setData("application/json",d)}catch(a){const n=l(i,t);e.dataTransfer.effectAllowed=n[0],e.dataTransfer.setData("Text",d)}}}(e,{data:this.dndDraggable,type:this.dndType},D.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),void 0===this.dndDragImageElementRef&&void 0===e._dndUsingHandle||function(e,n,t){const r=t(e,n)||{x:0,y:0};e.dataTransfer.setDragImage(n,r.x,r.y)}(e,this.dragImage,this.dndDragImageOffsetFunction);const n=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),n()});this.dndStart.emit(e),e.stopPropagation()}onDrag(e){this.dndDrag.emit(e)}onDragEnd(e){let n;switch(D.dropEffect){case"copy":n=this.dndCopied;break;case"link":n=this.dndLinked;break;case"move":n=this.dndMoved;break;default:n=this.dndCanceled}n.emit(e),this.dndEnd.emit(e),h(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),e.stopPropagation()}registerDragHandle(e){this.dndHandle=e}registerDragImage(e){this.dndDragImageElementRef=e}determineDragImage(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.o),r.Xb(r.N),r.Xb(r.H))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(e,n){1&e&&r.kc("dragstart",(function(e){return n.onDragStart(e)}))("dragend",(function(e){return n.onDragEnd(e)})),2&e&&r.Mb("draggable",n.draggable)},inputs:{dndEffectAllowed:"dndEffectAllowed",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf",dndDraggable:"dndDraggable",dndType:"dndType"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),e})(),v=(()=>{class e{constructor(e){this.elementRef=e}}return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.o))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndPlaceholderRef",""]]}),e})(),b=(()=>{class e{constructor(e,n,t){this.ngZone=e,this.elementRef=n,this.renderer=t,this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new r.r,this.dndDrop=new r.r,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=e=>this.onDragEnter(e),this.dragOverEventHandler=e=>this.onDragOver(e),this.dragLeaveEventHandler=e=>this.onDragLeave(e)}set dndDisableIf(e){this.disabled=!!e,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(e){this.dndDisableIf=e}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(e){if(!0===e._dndDropzoneActive)return void this.cleanupDragoverState();if(void 0===e._dndDropzoneActive){const n=document.elementFromPoint(e.clientX,e.clientY);this.elementRef.nativeElement.contains(n)&&(e._dndDropzoneActive=!0)}const n=p(e);!1!==this.isDropAllowed(n)&&e.preventDefault()}onDragOver(e){if(e.defaultPrevented)return;const n=p(e);if(!1===this.isDropAllowed(n))return;this.checkAndUpdatePlaceholderPosition(e);const t=f(e,this.dndEffectAllowed);"none"!==t?(e.preventDefault(),g(e,t),this.dndDragover.emit(e),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(e){try{const n=p(e);if(!1===this.isDropAllowed(n))return;const t=function(e,n){const t=s(e);return!0===n?null!==t&&a(t)?JSON.parse(e.dataTransfer.getData(t)):{}:JSON.parse(e.dataTransfer.getData(t))}(e,u());if(!1===this.isDropAllowed(t.type))return;e.preventDefault();const r=f(e);if(g(e,r),"none"===r)return;const d=this.getPlaceholderIndex();if(-1===d)return;this.dndDrop.emit({event:e,dropEffect:r,isExternal:u(),data:t.data,index:d,type:n}),e.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(e){if(void 0===e._dndDropzoneActive){const n=document.elementFromPoint(e.clientX,e.clientY);if(this.elementRef.nativeElement.contains(n))return void(e._dndDropzoneActive=!0)}this.cleanupDragoverState(),g(e,"none")}isDropAllowed(e){if(!0===this.disabled)return!1;if(!0===u()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone)return!0;if(!e)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(e)}tryGetPlaceholder(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(e){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const n=function(e,n){let t=n;for(;t.parentNode!==e;){if(!t.parentNode)return null;t=t.parentNode}return t}(this.elementRef.nativeElement,e.target);null!==n&&n!==this.placeholder&&(function(e,n,t){const r=n.getBoundingClientRect();return t?e.clientX<r.left+r.width/2:e.clientY<r.top+r.height/2}(e,n,this.dndHorizontal)?n.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,n):n.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,n.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.H),r.Xb(r.o),r.Xb(r.N))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDropzone",""]],contentQueries:function(e,n,t){var d;1&e&&r.Qb(t,v,!0),2&e&&r.zc(d=r.lc())&&(n.dndPlaceholderRef=d.first)},hostBindings:function(e,n){1&e&&r.kc("drop",(function(e){return n.onDrop(e)}))},inputs:{dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf",dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),e})(),E=(()=>{class e{}return e.\u0275mod=r.Vb({type:e}),e.\u0275inj=r.Ub({factory:function(n){return new(n||e)},imports:[[d.c]]}),e})()},EaEm:function(e,n,t){"use strict";t.d(n,"a",(function(){return g}));var r=t("mrSG"),d=t("YTAs"),i=t("dihp"),a=t("fXoL"),s=t("aceb"),l=t("+C6U"),o=t("ofXK");function c(e,n){if(1&e&&(a.dc(0,"nb-list-item",5),a.dc(1,"nb-alert",6),a.Oc(2),a.cc(),a.cc()),2&e){const e=n.$implicit;a.sc("dndDraggable",e),a.Lb(1),a.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),a.Lb(1),a.Qc(" ",e.applicationName,"")}}function h(e,n){if(1&e&&(a.dc(0,"nb-list-item",5),a.dc(1,"nb-alert",7),a.Oc(2),a.cc(),a.cc()),2&e){const e=n.$implicit;a.sc("dndDraggable",e),a.Lb(1),a.sc("accent","D"===e.environmentId?"success":"W"===e.environmentId?"warning":"M"===e.environmentId?"info":"basic"),a.Lb(1),a.Qc(" ",e.applicationName,"")}}let g=(()=>{class e{constructor(e,n,t){this.applicationService=e,this.roleService=n,this.toast=t,this.columns=[],this.isRequest=!1}ngOnInit(){this.columns=[{name:"M\xe3 c\u1ed9t",prop:"applicationName"},{name:"T\xean c\u1ed9t",prop:"alias"},{name:"Nh\xf3m",prop:"applicationGroup.applicationName"},{name:"Tr\u1ea1ng th\xe1i",prop:"isEnabled"},{name:"M\xf4i tr\u01b0\u1eddng",prop:"environmentId"}],this.roleService.getOne(this.roleId,{fields:["roleName","applications"],join:[{field:"applications",select:["applicationId","applicationName","environmentId"]}]}).subscribe(e=>{this.lstDataSelected=e.applications;const n=[{field:"isEnabled",operator:"$eq",value:!0}];this.lstDataSelected.length&&n.push({field:"applicationId",operator:"$notin",value:this.lstDataSelected.map(e=>e.applicationId)}),this.applicationService.getMany({fields:["applicationName","applicationGroup","isEnabled","environmentId"],filter:n}).subscribe(e=>this.lstDataAvailable=e)})}onDrop(e,n){return Object(r.a)(this,void 0,void 0,(function*(){const t=e.data,r=[...this.lstDataAvailable],d=[...this.lstDataSelected],i="remove"===n?this.lstDataAvailable:this.lstDataSelected,a="insert"===n?this.lstDataAvailable:this.lstDataSelected,s=a.findIndex(e=>e.applicationId===t.applicationId);if(s>-1){i.push(t),a.splice(s,1);try{this.isRequest=!0,yield this.roleService.patch(this.roleId,{applications:this.lstDataSelected}).toPromise()}catch(l){this.toast.danger(l&&l.message,"L\u1ed7i"),this.lstDataAvailable=r,this.lstDataSelected=d}finally{this.isRequest=!1}}}))}}return e.\u0275fac=function(n){return new(n||e)(a.Xb(d.b),a.Xb(i.b),a.Xb(s.qb))},e.\u0275cmp=a.Rb({type:e,selectors:[["ga-application"]],inputs:{roleId:"roleId"},decls:13,vars:3,consts:[[1,"row",3,"nbSpinner"],[1,"col-md-6"],["dndDropzone","",1,"dndList",3,"dndDrop"],["dndPlaceholderRef","",1,"dndPlaceholder"],[3,"dndDraggable",4,"ngFor","ngForOf"],[3,"dndDraggable"],[1,"full-width",3,"accent"],[3,"accent"]],template:function(e,n){1&e&&(a.dc(0,"div",0),a.dc(1,"div",1),a.dc(2,"nb-card-header"),a.Oc(3,"\u1ee8ng d\u1ee5ng ch\u01b0a ch\u1ecdn"),a.cc(),a.dc(4,"nb-list",2),a.kc("dndDrop",(function(e){return n.onDrop(e,"remove")})),a.Yb(5,"nb-list-item",3),a.Mc(6,c,3,3,"nb-list-item",4),a.cc(),a.cc(),a.dc(7,"div",1),a.dc(8,"nb-card-header"),a.Oc(9,"\u1ee8ng d\u1ee5ng \u0111\xe3 ch\u1ecdn"),a.cc(),a.dc(10,"nb-list",2),a.kc("dndDrop",(function(e){return n.onDrop(e,"insert")})),a.Yb(11,"nb-list-item",3),a.Mc(12,h,3,3,"nb-list-item",4),a.cc(),a.cc(),a.cc()),2&e&&(a.sc("nbSpinner",n.isRequest),a.Lb(6),a.sc("ngForOf",n.lstDataAvailable),a.Lb(6),a.sc("ngForOf",n.lstDataSelected))},directives:[s.kb,s.t,s.P,l.b,s.Q,l.d,o.t,l.a,s.j],styles:["nb-list[_ngcontent-%COMP%]{height:100%}.dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndList.dndDragover[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.dndDragging[_ngcontent-%COMP%]{border:1px solid green}.dndPlaceholder[_ngcontent-%COMP%]{min-height:72px;border:1px dashed green;background-color:rgba(0,0,0,.1)}nb-alert[_ngcontent-%COMP%]{margin:0;padding:6px 12px}"]}),e})()},ronx:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var r=t("ofXK"),d=t("1ua0"),i=t("aceb"),a=t("+C6U"),s=t("fXoL");let l=(()=>{class e{}return e.\u0275mod=s.Vb({type:e}),e.\u0275inj=s.Ub({factory:function(n){return new(n||e)},imports:[[r.c,d.a,i.u,i.p,i.R,i.lb,i.k,a.c]]}),e})()},tvm6:function(e,n,t){"use strict";t.d(n,"a",(function(){return h}));var r=t("ofXK"),d=t("1ua0"),i=t("aceb"),a=t("BDdu"),s=t("3Pt+"),l=t("DS98"),o=t("ExIg"),c=t("fXoL");let h=(()=>{class e{}return e.\u0275mod=c.Vb({type:e}),e.\u0275inj=c.Ub({factory:function(n){return new(n||e)},imports:[[r.c,d.a,i.k,a.a,i.w,s.g,l.a,i.H,i.p,i.sb,i.lb,i.u,o.e]]}),e})()}}]);