!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function t(e,n){return(t=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function r(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=a(e);if(n){var d=a(this).constructor;t=Reflect.construct(r,arguments,d)}else t=r.apply(this,arguments);return i(this,t)}}function i(e,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+C6U":function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"d",(function(){return y})),t.d(n,"b",(function(){return E})),t.d(n,"c",(function(){return w}));var r=t("fXoL"),i=t("ofXK"),a=["move","copy","link"];function o(e){return"application/x-dnd"===e.substr(0,"application/x-dnd".length)}function s(e){if(e.dataTransfer){var n=e.dataTransfer.types;if(!n)return"Text";for(var t=0;t<n.length;t++)if("Text"===n[t]||"application/json"===n[t]||o(n[t]))return n[t]}return null}function c(e,n){return"all"===n||"uninitialized"===n?e:e.filter((function(e){return-1!==n.toLowerCase().indexOf(e)}))}function f(e,n){var t=window.getComputedStyle(n),r=parseFloat(t.paddingTop)||0,i=parseFloat(t.paddingLeft)||0,a=parseFloat(t.borderTopWidth)||0,d=parseFloat(t.borderLeftWidth)||0;return{x:e.offsetX+i+d,y:e.offsetY+r+a}}var u={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function p(){u.isDragging=!1,u.dropEffect=void 0,u.effectAllowed=void 0,u.type=void 0}function h(e,n){!0===u.isDragging&&(u.dropEffect=n),e.dataTransfer.dropEffect=n}function g(e,n){var t=c(a,e.dataTransfer?e.dataTransfer.effectAllowed:"uninitialized");return!0===u.isDragging&&(t=c(t,u.effectAllowed)),n&&(t=c(t,n)),0===t.length?"none":e.ctrlKey&&-1!==t.indexOf("copy")?"copy":e.altKey&&-1!==t.indexOf("link")?"link":t[0]}function v(e){if(!0===u.isDragging)return u.type;var n=s(e);return null!==n&&"Text"!==n&&"application/json"!==n&&n.substr("application/x-dnd".length+1)||void 0}function m(){return!1===u.isDragging}var D=u,b=function(){var e=function(){function e(n,t,i){var a=this;d(this,e),this.elementRef=n,this.renderer=t,this.ngZone=i,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=f,this.dndStart=new r.r,this.dndDrag=new r.r,this.dndEnd=new r.r,this.dndMoved=new r.r,this.dndCopied=new r.r,this.dndLinked=new r.r,this.dndCanceled=new r.r,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=function(e){return a.onDrag(e)}}return l(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular((function(){e.elementRef.nativeElement.addEventListener("drag",e.dragEventHandler)}))}},{key:"ngOnDestroy",value:function(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&p()}},{key:"onDragStart",value:function(e){var n=this;if(!1===this.draggable)return!1;if(void 0!==this.dndHandle&&void 0===e._dndUsingHandle)return!1;!function(e,n,t){u.isDragging=!0,u.dropEffect="none",u.effectAllowed=n,u.type=t,e.dataTransfer.effectAllowed=n}(e,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function(e,n,t){var r="application/x-dnd"+(n.type?"-"+n.type:""),i=JSON.stringify(n);try{e.dataTransfer.setData(r,i)}catch(o){try{e.dataTransfer.setData("application/json",i)}catch(o){var d=c(a,t);e.dataTransfer.effectAllowed=d[0],e.dataTransfer.setData("Text",i)}}}(e,{data:this.dndDraggable,type:this.dndType},D.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),void 0===this.dndDragImageElementRef&&void 0===e._dndUsingHandle||function(e,n,t){var r=t(e,n)||{x:0,y:0};e.dataTransfer.setDragImage(n,r.x,r.y)}(e,this.dragImage,this.dndDragImageOffsetFunction);var t=this.renderer.listen(this.elementRef.nativeElement,"drag",(function(){n.renderer.addClass(n.elementRef.nativeElement,n.dndDraggingSourceClass),t()}));this.dndStart.emit(e),e.stopPropagation()}},{key:"onDrag",value:function(e){this.dndDrag.emit(e)}},{key:"onDragEnd",value:function(e){var n,t=this;switch(D.dropEffect){case"copy":n=this.dndCopied;break;case"link":n=this.dndLinked;break;case"move":n=this.dndMoved;break;default:n=this.dndCanceled}n.emit(e),this.dndEnd.emit(e),p(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout((function(){t.renderer.removeClass(t.elementRef.nativeElement,t.dndDraggingSourceClass)}),0),e.stopPropagation()}},{key:"registerDragHandle",value:function(e){this.dndHandle=e}},{key:"registerDragImage",value:function(e){this.dndDragImageElementRef=e}},{key:"determineDragImage",value:function(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}},{key:"dndDisableIf",set:function(e){this.draggable=!e,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}},{key:"dndDisableDragIf",set:function(e){this.dndDisableIf=e}}]),e}();return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.o),r.Xb(r.N),r.Xb(r.H))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(e,n){1&e&&r.kc("dragstart",(function(e){return n.onDragStart(e)}))("dragend",(function(e){return n.onDragEnd(e)})),2&e&&r.Mb("draggable",n.draggable)},inputs:{dndEffectAllowed:"dndEffectAllowed",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf",dndDraggable:"dndDraggable",dndType:"dndType"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),e}(),y=function(){var e=function e(n){d(this,e),this.elementRef=n};return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.o))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndPlaceholderRef",""]]}),e}(),E=function(){var e=function(){function e(n,t,i){var a=this;d(this,e),this.ngZone=n,this.elementRef=t,this.renderer=i,this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new r.r,this.dndDrop=new r.r,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=function(e){return a.onDragEnter(e)},this.dragOverEventHandler=function(e){return a.onDragOver(e)},this.dragLeaveEventHandler=function(e){return a.onDragLeave(e)}}return l(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular((function(){e.elementRef.nativeElement.addEventListener("dragenter",e.dragEnterEventHandler),e.elementRef.nativeElement.addEventListener("dragover",e.dragOverEventHandler),e.elementRef.nativeElement.addEventListener("dragleave",e.dragLeaveEventHandler)}))}},{key:"ngOnDestroy",value:function(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}},{key:"onDragEnter",value:function(e){if(!0!==e._dndDropzoneActive){if(void 0===e._dndDropzoneActive){var n=document.elementFromPoint(e.clientX,e.clientY);this.elementRef.nativeElement.contains(n)&&(e._dndDropzoneActive=!0)}var t=v(e);!1!==this.isDropAllowed(t)&&e.preventDefault()}else this.cleanupDragoverState()}},{key:"onDragOver",value:function(e){if(!e.defaultPrevented){var n=v(e);if(!1!==this.isDropAllowed(n)){this.checkAndUpdatePlaceholderPosition(e);var t=g(e,this.dndEffectAllowed);"none"!==t?(e.preventDefault(),h(e,t),this.dndDragover.emit(e),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}}}},{key:"onDrop",value:function(e){try{var n=v(e);if(!1===this.isDropAllowed(n))return;var t=function(e,n){var t=s(e);return!0===n?null!==t&&o(t)?JSON.parse(e.dataTransfer.getData(t)):{}:JSON.parse(e.dataTransfer.getData(t))}(e,m());if(!1===this.isDropAllowed(t.type))return;e.preventDefault();var r=g(e);if(h(e,r),"none"===r)return;var i=this.getPlaceholderIndex();if(-1===i)return;this.dndDrop.emit({event:e,dropEffect:r,isExternal:m(),data:t.data,index:i,type:n}),e.stopPropagation()}finally{this.cleanupDragoverState()}}},{key:"onDragLeave",value:function(e){if(void 0===e._dndDropzoneActive){var n=document.elementFromPoint(e.clientX,e.clientY);if(this.elementRef.nativeElement.contains(n))return void(e._dndDropzoneActive=!0)}this.cleanupDragoverState(),h(e,"none")}},{key:"isDropAllowed",value:function(e){if(!0===this.disabled)return!1;if(!0===m()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone)return!0;if(!e)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(e)}},{key:"tryGetPlaceholder",value:function(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}},{key:"removePlaceholderFromDOM",value:function(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}},{key:"checkAndUpdatePlaceholderPosition",value:function(e){if(null!==this.placeholder){this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);var n=function(e,n){for(var t=n;t.parentNode!==e;){if(!t.parentNode)return null;t=t.parentNode}return t}(this.elementRef.nativeElement,e.target);null!==n&&n!==this.placeholder&&(function(e,n,t){var r=n.getBoundingClientRect();return t?e.clientX<r.left+r.width/2:e.clientY<r.top+r.height/2}(e,n,this.dndHorizontal)?n.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,n):n.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,n.nextSibling))}}},{key:"getPlaceholderIndex",value:function(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}},{key:"cleanupDragoverState",value:function(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}},{key:"dndDisableIf",set:function(e){this.disabled=!!e,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}},{key:"dndDisableDropIf",set:function(e){this.dndDisableIf=e}}]),e}();return e.\u0275fac=function(n){return new(n||e)(r.Xb(r.H),r.Xb(r.o),r.Xb(r.N))},e.\u0275dir=r.Sb({type:e,selectors:[["","dndDropzone",""]],contentQueries:function(e,n,t){var i;1&e&&r.Qb(t,y,!0),2&e&&r.zc(i=r.lc())&&(n.dndPlaceholderRef=i.first)},hostBindings:function(e,n){1&e&&r.kc("drop",(function(e){return n.onDrop(e)}))},inputs:{dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf",dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),e}(),w=function(){var e=function e(){d(this,e)};return e.\u0275mod=r.Vb({type:e}),e.\u0275inj=r.Ub({factory:function(n){return new(n||e)},imports:[[i.c]]}),e}()},EaEm:function(n,i,a){"use strict";a.d(i,"a",(function(){return I}));var o,s=a("mrSG"),c=a("YTAs"),f=a("dihp"),u=a("AytR"),p=a("WJ/N"),h=a("fXoL"),g=a("tk/3"),v=((o=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(i,e);var n=r(i);function i(e){return d(this,i),n.call(this,{apiUrl:u.a.apiUrl,entity:"sys/role-application"},e)}return i}(p.a)).\u0275fac=function(e){return new(e||o)(h.hc(g.b))},o.\u0275prov=h.Tb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),m=a("aceb"),D=a("+C6U"),b=a("ofXK");function y(e,n){if(1&e&&(h.dc(0,"nb-list-item",5),h.dc(1,"nb-alert",6),h.Oc(2),h.cc(),h.cc()),2&e){var t=n.$implicit;h.sc("dndDraggable",t),h.Lb(1),h.sc("accent","D"===t.environmentId?"success":"W"===t.environmentId?"warning":"M"===t.environmentId?"info":"basic"),h.Lb(1),h.Qc(" ",t.applicationName,"")}}function E(e,n){if(1&e&&(h.dc(0,"nb-list-item",5),h.dc(1,"nb-alert",7),h.Oc(2),h.cc(),h.cc()),2&e){var t=n.$implicit;h.sc("dndDraggable",t),h.Lb(1),h.sc("accent","D"===t.environmentId?"success":"W"===t.environmentId?"warning":"M"===t.environmentId?"info":"basic"),h.Lb(1),h.Qc(" ",t.applicationName,"")}}var w,I=((w=function(){function n(e,t,r,i){d(this,n),this.applicationService=e,this.roleService=t,this.toast=r,this.roleApplicationService=i,this.columns=[],this.isRequest=!1}return l(n,[{key:"ngOnInit",value:function(){var e=this;this.columns=[{name:"M\xe3 c\u1ed9t",prop:"applicationName"},{name:"T\xean c\u1ed9t",prop:"alias"},{name:"Nh\xf3m",prop:"applicationGroup.applicationName"},{name:"Tr\u1ea1ng th\xe1i",prop:"isEnabled"},{name:"M\xf4i tr\u01b0\u1eddng",prop:"environmentId"}],this.roleService.getOne(this.roleId,{fields:["roleName","applications"],join:[{field:"applications",select:["applicationId","applicationName","environmentId"]}]}).subscribe((function(n){e.lstDataSelected=n.applications;var t=[{field:"isEnabled",operator:"$eq",value:!0}];e.lstDataSelected.length&&t.push({field:"applicationId",operator:"$notin",value:e.lstDataSelected.map((function(e){return e.applicationId}))}),e.applicationService.getMany({fields:["applicationName","applicationGroup","isEnabled","environmentId"],filter:t}).subscribe((function(n){return e.lstDataAvailable=n}))}))}},{key:"onDrop",value:function(n,t){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,a,d,o,l,s,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.data,a=e(this.lstDataAvailable),d=e(this.lstDataSelected),o="remove"===t?this.lstDataAvailable:this.lstDataSelected,l="insert"===t?this.lstDataAvailable:this.lstDataSelected,!((s=l.findIndex((function(e){return e.applicationId===i.applicationId})))>-1)){r.next=26;break}if(o.push(i),l.splice(s,1),r.prev=3,this.isRequest=!0,"remove"!==t){r.next=14;break}return r.next=7,this.roleApplicationService.getMany({filter:[{field:"roleId",operator:"$eq",value:this.roleId},{field:"applicationId",operator:"$eq",value:i.applicationId}],limit:1}).toPromise();case 7:if(c=r.sent,r.t0=c&&c.length>0,!r.t0){r.next=12;break}return r.next=12,this.roleApplicationService.delete(c[0].id).toPromise();case 12:r.next=18;break;case 14:if(r.t1="insert"===t,!r.t1){r.next=18;break}return r.next=18,this.roleApplicationService.create({roleId:this.roleId,applicationId:i.applicationId}).toPromise();case 18:r.next=23;break;case 20:r.prev=20,r.t2=r.catch(3),this.toast.danger(r.t2&&r.t2.message,"L\u1ed7i"),this.lstDataAvailable=a,this.lstDataSelected=d;case 23:return r.prev=23,this.isRequest=!1,r.finish(23);case 26:case"end":return r.stop()}}),r,this,[[3,20,23,26]])})))}}]),n}()).\u0275fac=function(e){return new(e||w)(h.Xb(c.b),h.Xb(f.b),h.Xb(m.qb),h.Xb(v))},w.\u0275cmp=h.Rb({type:w,selectors:[["ga-application"]],inputs:{roleId:"roleId"},decls:13,vars:3,consts:[[1,"row",3,"nbSpinner"],[1,"col-md-6"],["dndDropzone","",1,"dndList",3,"dndDrop"],["dndPlaceholderRef","",1,"dndPlaceholder"],[3,"dndDraggable",4,"ngFor","ngForOf"],[3,"dndDraggable"],[1,"full-width",3,"accent"],[3,"accent"]],template:function(e,n){1&e&&(h.dc(0,"div",0),h.dc(1,"div",1),h.dc(2,"nb-card-header"),h.Oc(3,"\u1ee8ng d\u1ee5ng ch\u01b0a ch\u1ecdn"),h.cc(),h.dc(4,"nb-list",2),h.kc("dndDrop",(function(e){return n.onDrop(e,"remove")})),h.Yb(5,"nb-list-item",3),h.Mc(6,y,3,3,"nb-list-item",4),h.cc(),h.cc(),h.dc(7,"div",1),h.dc(8,"nb-card-header"),h.Oc(9,"\u1ee8ng d\u1ee5ng \u0111\xe3 ch\u1ecdn"),h.cc(),h.dc(10,"nb-list",2),h.kc("dndDrop",(function(e){return n.onDrop(e,"insert")})),h.Yb(11,"nb-list-item",3),h.Mc(12,E,3,3,"nb-list-item",4),h.cc(),h.cc(),h.cc()),2&e&&(h.sc("nbSpinner",n.isRequest),h.Lb(6),h.sc("ngForOf",n.lstDataAvailable),h.Lb(6),h.sc("ngForOf",n.lstDataSelected))},directives:[m.kb,m.t,m.P,D.b,m.Q,D.d,b.t,D.a,m.j],styles:["nb-list[_ngcontent-%COMP%]{height:100%}.dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndList.dndDragover[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.dndDragging[_ngcontent-%COMP%]{border:1px solid green}.dndPlaceholder[_ngcontent-%COMP%]{min-height:72px;border:1px dashed green;background-color:rgba(0,0,0,.1)}nb-alert[_ngcontent-%COMP%]{margin:0;padding:6px 12px}"]}),w)},ronx:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t("ofXK"),i=t("1ua0"),a=t("aceb"),o=t("+C6U"),l=t("fXoL"),s=function(){var e=function e(){d(this,e)};return e.\u0275mod=l.Vb({type:e}),e.\u0275inj=l.Ub({factory:function(n){return new(n||e)},imports:[[r.c,i.a,a.u,a.p,a.R,a.lb,a.k,o.c]]}),e}()},tvm6:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t("ofXK"),i=t("1ua0"),a=t("aceb"),o=t("BDdu"),l=t("3Pt+"),s=t("DS98"),c=t("ExIg"),f=t("fXoL"),u=function(){var e=function e(){d(this,e)};return e.\u0275mod=f.Vb({type:e}),e.\u0275inj=f.Ub({factory:function(n){return new(n||e)},imports:[[r.c,i.a,a.k,o.a,a.w,l.g,s.a,a.H,a.p,a.sb,a.lb,a.u,c.e]]}),e}()}}])}();