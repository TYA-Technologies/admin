(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{U3uG:function(e,t,c){"use strict";c.r(t),c.d(t,"RoleModule",(function(){return _}));var n=c("ofXK"),i=c("mrSG"),l=c("dihp"),o=c("advQ"),a=c("ExIg"),s=c("cp0P"),d=c("nYR2"),r=c("fXoL"),u=c("tyNb"),h=c("aceb"),b=c("3Pt+"),m=c("NL+w"),g=c("wnGv"),p=c("GwA9");const f=["table"],y=["tplCellStatus"],E=["tplCellSum"],v=["tplCellRoleParent"];function k(e,t){if(1&e){const e=r.ec();r.dc(0,"div"),r.dc(1,"nb-card"),r.dc(2,"nb-card-header"),r.Oc(3,"Ch\u1ec9nh s\u1eeda"),r.cc(),r.dc(4,"nb-card-body"),r.dc(5,"div",0),r.dc(6,"div",18),r.dc(7,"label",4),r.dc(8,"strong"),r.Oc(9,"Nh\xf3m quy\u1ec1n"),r.cc(),r.cc(),r.dc(10,"ga-tree",5,6),r.kc("itemSelectedChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.roleParent=t})),r.cc(),r.cc(),r.dc(12,"div",19),r.dc(13,"nb-radio-group",20),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.status=t})),r.dc(14,"nb-radio",21),r.dc(15,"nb-alert",22),r.Oc(16," M\u1edf "),r.cc(),r.cc(),r.dc(17,"nb-radio",21),r.dc(18,"nb-alert",23),r.Oc(19," Kh\xf3a "),r.cc(),r.cc(),r.dc(20,"nb-radio",21),r.dc(21,"nb-alert",24),r.Oc(22," \u1ea8n "),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.dc(23,"nb-card-footer",25),r.dc(24,"button",26),r.kc("click",(function(){return r.Dc(e),r.mc().cancelMulEdit()})),r.Oc(25," H\u1ee7y "),r.cc(),r.dc(26,"button",27),r.kc("click",(function(){return r.Dc(e),r.mc().mulEditSubmit()})),r.Oc(27," C\u1eadp nh\u1eadt "),r.cc(),r.cc(),r.cc(),r.cc()}if(2&e){const e=r.mc();r.Lb(10),r.sc("displayRefresh",!0)("config",e.treeConfig)("itemSelected",e.mulEditEntity.roleParent),r.Lb(3),r.sc("ngModel",e.mulEditEntity.status),r.Lb(1),r.sc("value",e.RoleStatusEnum.Open),r.Lb(3),r.sc("value",e.RoleStatusEnum.Lock),r.Lb(3),r.sc("value",e.RoleStatusEnum.Hide),r.Lb(6),r.sc("disabled",e.isMulEditingReq)("nbSpinner",e.isMulEditingReq)}}function M(e,t){if(1&e&&(r.dc(0,"nb-alert",30),r.Oc(1),r.cc()),2&e){const e=r.mc().value,t=r.mc();r.sc("status",e===t.RoleStatusEnum.Hide?"default":e===t.RoleStatusEnum.Lock?"danger":e===t.RoleStatusEnum.Open?"success":""),r.Lb(1),r.Qc(" ",e===t.RoleStatusEnum.Hide?"\u1ea8n":e===t.RoleStatusEnum.Lock?"Kh\xf3a":e===t.RoleStatusEnum.Open?"M\u1edf":""," ")}}function C(e,t){if(1&e){const e=r.ec();r.dc(0,"nb-select",20),r.kc("ngModelChange",(function(t){r.Dc(e);const c=r.mc();return c.rowEdit[c.column.prop]=t})),r.dc(1,"nb-option",21),r.Oc(2,"M\u1edf"),r.cc(),r.dc(3,"nb-option",21),r.Oc(4,"Kh\xf3a"),r.cc(),r.dc(5,"nb-option",21),r.Oc(6,"\u1ea8n"),r.cc(),r.cc()}if(2&e){const e=r.mc(),t=e.rowEdit,c=e.column,n=r.mc();r.sc("ngModel",t[c.prop]),r.Lb(1),r.sc("value",n.RoleStatusEnum.Open),r.Lb(2),r.sc("value",n.RoleStatusEnum.Lock),r.Lb(2),r.sc("value",n.RoleStatusEnum.Hide)}}function S(e,t){if(1&e&&(r.Mc(0,M,2,2,"nb-alert",28),r.Mc(1,C,7,4,"nb-select",29)),2&e){const e=t.isEdit;r.sc("ngIf",!e),r.Lb(1),r.sc("ngIf",e)}}function w(e,t){1&e&&r.Oc(0),2&e&&r.Qc(" ",t.value.length,"\n")}function I(e,t){if(1&e&&(r.bc(0),r.Oc(1),r.ac()),2&e){const e=r.mc().value;r.Lb(1),r.Qc(" ",e.roleName," ")}}function L(e,t){if(1&e){const e=r.ec();r.bc(0),r.dc(1,"ga-tree",31),r.kc("itemSelectedChange",(function(t){return r.Dc(e),r.mc().rowEdit.roleParent=t})),r.cc(),r.ac()}if(2&e){const e=r.mc(2);r.Lb(1),r.sc("config",e.treeConfig)}}function D(e,t){if(1&e&&(r.Mc(0,I,2,1,"ng-container",12),r.Mc(1,L,2,1,"ng-container",12)),2&e){const e=t.isEdit;r.sc("ngIf",!e),r.Lb(1),r.sc("ngIf",e)}}let O=(()=>{class e{constructor(e,t,c,n){this.roleService=e,this.router=t,this.activatedRoute=c,this.toast=n,this.RoleStatusEnum=o.a,this.ColumnMode=a.a,this.columns=[],this.bulkActions=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"},{name:"delete",title:"X\xf3a"}],this.actions=[{name:"quick-edit"},{name:"application",icon:'<i class="fab fa-windows"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp \xfang d\u1ee5ng",click:e=>this.viewApplication(e)},{name:"layer",icon:'<i class="fas fa-layer-group"></i>',tooltip:"Xem quy\u1ec1n truy c\u1eadp l\u1edbp d\u1eef li\u1ec7u",click:e=>this.viewLayer(e)},{name:"delete"}],this.datatableService={service:this.roleService,primaryField:"roleId",builder:this.getDataServiceBuilder.bind(this)},this.filterSelectConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldGroup:"roleParentId"},this.entityAdd={},this.isAdding=!1,this.treeConfig={displayValueAll:!0,service:this.roleService,fieldValue:"roleId",fieldName:"roleName",fieldParent:"roleParentId"},this.filterEntity={roleName:"",roleParentId:null},this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}ngOnInit(){this.columns=[{name:"T\xean",prop:"roleName",flexGrow:1,type:"string"},{name:"Nh\xf3m",prop:"roleParent",minWidth:270,cellTemplate:this.tplCellRoleParent},{name:"T\xe0i kho\u1ea3n",prop:"users",width:70,cellTemplate:this.tplCellSum},{name:"Tr\u1ea1ng th\xe1i",prop:"status",maxWidth:170,type:"boolean",cellTemplate:this.tplCellStatus}]}getDataServiceBuilder(e){e.select(["roleName","roleParent","users","status"]),e.setJoin([{field:"roleParent",select:["roleName"]},{field:"users",select:["userId"]}]);const{roleName:t,roleParentId:c}=this.filterEntity;c&&e.setFilter({field:"roleParentId",operator:"$eq",value:c}),t&&e.setFilter({field:"roleName",operator:"$cont",value:t})}viewApplication(e){this.router.navigate([e.roleId,"application"],{relativeTo:this.activatedRoute})}viewLayer(e){this.router.navigate([e.roleId,"layer"],{relativeTo:this.activatedRoute})}buttonNewClick(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.entityAdd.roleName)try{this.isAdding=!0,yield this.roleService.create(this.entityAdd).toPromise(),this.toast.success("Th\xeam m\u1edbi th\xe0nh c\xf4ng","Th\xf4ng b\xe1o"),this.table.loadData()}catch(e){this.toast.danger(e&&e.message,"L\u1ed7i")}finally{this.isAdding=!1}else this.toast.warning("Nh\u1eadp t\xean quy\u1ec1n","L\u1ed7i nh\u1eadp li\u1ec7u")}))}filter(){this.table.loadData()}selectedItem(e){this.tblItemSelected=e.selected}bulkClick(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={})}get isMulEdit(){return Boolean(this.mulEditEntity)}mulEditSubmit(){this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(s.a)(this.tblItemSelected.map(e=>this.roleService.patch(e.roleId,{roleParent:this.mulEditEntity.roleParent,status:this.mulEditEntity.status}))).pipe(Object(d.a)(()=>{this.isMulEditingReq=!1,delete this.subcriberMulEdit,delete this.mulEditEntity})).subscribe(e=>{this.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),this.table.loadData()},e=>{this.toast.danger(e&&e.message,"L\u1ed7i")}))}cancelMulEdit(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(l.b),r.Xb(u.c),r.Xb(u.a),r.Xb(h.qb))},e.\u0275cmp=r.Rb({type:e,selectors:[["ga-role"]],viewQuery:function(e,t){var c;1&e&&(r.Jc(f,!0),r.Jc(y,!0),r.Jc(E,!0),r.Jc(v,!0)),2&e&&(r.zc(c=r.lc())&&(t.table=c.first),r.zc(c=r.lc())&&(t.tplCellStatus=c.first),r.zc(c=r.lc())&&(t.tplCellSum=c.first),r.zc(c=r.lc())&&(t.tplCellRoleParent=c.first))},decls:39,vars:19,consts:[[1,"row"],[1,"col-md-12"],[1,"col-md-4"],["nbInput","","fieldSize","small","fullWidth","","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["for","",1,"form-input"],["fullWidth","",1,"form-input",3,"displayRefresh","config","itemSelected","itemSelectedChange"],["tree",""],["nbButton","","size","small",3,"disabled","nbSpinner","click"],[1,"col-md-8"],["placeholder","Nh\xf3m quy\u1ec1n",1,"form-input",3,"config","value","valueChange"],["nbInput","","fieldSize","small","type","text","placeholder","T\xean quy\u1ec1n",1,"form-input",3,"ngModel","ngModelChange"],["nbButton","","size","small","outline","","status","primary",1,"form-input",3,"click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped","mt-2",3,"externalPaging","columns","datatableService","actions","columnMode","limit","bulkActions","rowHeight","selected","select","bulkClick"],["table",""],["tplCellStatus",""],["tplCellSum",""],["tplCellRoleParent",""],[1,"col-md-9","col-xs-12"],[1,"col-md-3","col-xs-12"],[3,"ngModel","ngModelChange"],[3,"value"],["gaTag","","status","success"],["gaTag","","status","danger"],["gaTag","","status","default"],[1,"d-flex","justify-content-between"],["status","danger","nbButton","","size","small","outline","",3,"click"],["nbButton","","size","small","status","primary",3,"disabled","nbSpinner","click"],["gaTag","",3,"status",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["gaTag","",3,"status"],[1,"tree",3,"config","itemSelectedChange"]],template:function(e,t){if(1&e){const e=r.ec();r.dc(0,"div",0),r.dc(1,"div",1),r.dc(2,"nb-card"),r.dc(3,"nb-card-header"),r.Oc(4,"Quy\u1ec1n"),r.cc(),r.dc(5,"nb-card-body"),r.dc(6,"div",0),r.dc(7,"div",2),r.dc(8,"nb-card"),r.dc(9,"nb-card-header"),r.Oc(10,"Th\xeam m\u1edbi"),r.cc(),r.dc(11,"nb-card-body"),r.dc(12,"input",3),r.kc("ngModelChange",(function(e){return t.entityAdd.roleName=e})),r.cc(),r.dc(13,"label",4),r.dc(14,"strong"),r.Oc(15,"Nh\xf3m quy\u1ec1n"),r.cc(),r.cc(),r.dc(16,"ga-tree",5,6),r.kc("itemSelectedChange",(function(e){return t.entityAdd.roleParent=e})),r.cc(),r.cc(),r.dc(18,"nb-card-footer"),r.dc(19,"button",7),r.kc("click",(function(){r.Dc(e);const c=r.Ac(17);return t.buttonNewClick(),c.loadData()})),r.Oc(20," Th\xeam m\u1edbi "),r.cc(),r.cc(),r.cc(),r.cc(),r.dc(21,"div",8),r.dc(22,"div",0),r.dc(23,"div",1),r.dc(24,"div"),r.dc(25,"ga-select",9),r.kc("valueChange",(function(e){return t.filterEntity.roleParentId=e})),r.cc(),r.dc(26,"input",10),r.kc("ngModelChange",(function(e){return t.filterEntity.roleName=e})),r.cc(),r.dc(27,"button",11),r.kc("click",(function(){return t.filter()})),r.Oc(28," L\u1ecdc "),r.cc(),r.Mc(29,k,28,9,"div",12),r.cc(),r.dc(30,"ngn-datatable",13,14),r.kc("select",(function(e){return t.selectedItem(e)}))("bulkClick",(function(e){return t.bulkClick(e)})),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.cc(),r.Mc(32,S,2,2,"ng-template",null,15,r.Nc),r.Mc(34,w,1,1,"ng-template",null,16,r.Nc),r.Mc(36,D,2,2,"ng-template",null,17,r.Nc),r.Yb(38,"router-outlet")}2&e&&(r.Lb(12),r.sc("ngModel",t.entityAdd.roleName),r.Lb(4),r.sc("displayRefresh",!0)("config",t.treeConfig)("itemSelected",t.entityAdd.roleParent),r.Lb(3),r.sc("disabled",t.isMulEdit)("nbSpinner",t.isAdding),r.Lb(6),r.sc("config",t.filterSelectConfig)("value",t.filterEntity.roleParentId),r.Lb(1),r.sc("ngModel",t.filterEntity.roleName),r.Lb(3),r.sc("ngIf",t.isMulEdit),r.Lb(1),r.sc("externalPaging",!0)("columns",t.columns)("datatableService",t.datatableService)("actions",t.actions)("columnMode",t.ColumnMode.force)("limit",10)("bulkActions",t.bulkActions)("rowHeight","auto")("selected",t.tblItemSelected))},directives:[h.r,h.t,h.q,h.G,b.b,b.j,b.m,m.a,h.s,h.o,h.kb,g.a,n.u,a.d,u.h,h.bb,h.ab,h.j,p.a,h.fb,h.W],styles:[".body[_ngcontent-%COMP%]{width:240px;height:70vh}.tree[_ngcontent-%COMP%]{max-height:240px;overflow:auto}.card-filter[_ngcontent-%COMP%]{max-height:300px}"]}),e})();var x=c("BDdu"),R=c("1ua0"),T=c("ronx"),N=c("6n0X"),P=c("DS98"),q=c("tvm6"),A=c("jF+W"),G=c("EaEm");const B=["dlg"];let z=(()=>{class e{constructor(e,t){this.router=e,this.activatedRoute=t,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}ngOnInit(){this.roleId=this.activatedRoute.snapshot.paramMap.get("roleId")}closeViewField(){this.router.navigate(["../.."],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.dlg.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(u.c),r.Xb(u.a))},e.\u0275cmp=r.Rb({type:e,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&r.Jc(B,!0),2&e&&r.zc(c=r.lc())&&(t.dlg=c.first)},decls:9,vars:9,consts:[[3,"open","userConfig"],["dlg",""],[3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){1&e&&(r.dc(0,"core-dialog",0,1),r.dc(2,"core-dialog-header"),r.Oc(3,"\u1ee8ng d\u1ee5ng"),r.cc(),r.dc(4,"core-dialog-body"),r.Yb(5,"ga-application",2),r.cc(),r.dc(6,"core-dialog-footer"),r.dc(7,"button",3),r.kc("click",(function(){return t.closeViewField()})),r.Oc(8,"\u0110\xf3ng"),r.cc(),r.cc(),r.cc()),2&e&&(r.sc("open",!0)("userConfig",t.userConfig),r.Lb(4),r.Kc("width",80,"vw")("max-height",70,"vh")("overflow","auto"),r.Lb(1),r.sc("roleId",t.roleId))},directives:[A.b,A.d,A.a,G.a,A.c,h.o],encapsulation:2}),e})();var X=c("bANk"),V=c("CjdU");const F=["table"];function j(e,t){if(1&e){const e=r.ec();r.dc(0,"div"),r.dc(1,"nb-card",23),r.dc(2,"nb-card-header"),r.Oc(3,"Ch\u1ec9nh s\u1eeda"),r.cc(),r.dc(4,"nb-card-body"),r.dc(5,"div",24),r.dc(6,"nb-checkbox",25),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.isView=t})),r.Oc(7,"\u0110\u01b0\u1ee3c ph\xe9p xem"),r.cc(),r.dc(8,"nb-checkbox",25),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.isCreate=t})),r.Oc(9,"\u0110\u01b0\u1ee3c ph\xe9p t\u1ea1o"),r.cc(),r.dc(10,"nb-checkbox",25),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.isEdit=t})),r.Oc(11,"\u0110\u01b0\u1ee3c ph\xe9p ch\u1ec9nh s\u1eeda"),r.cc(),r.dc(12,"nb-checkbox",25),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.isDelete=t})),r.Oc(13,"\u0110\u01b0\u1ee3c ph\xe9p x\xf3a"),r.cc(),r.cc(),r.dc(14,"div",24),r.dc(15,"input",26),r.kc("ngModelChange",(function(t){return r.Dc(e),r.mc().mulEditEntity.definition=t})),r.cc(),r.cc(),r.cc(),r.dc(16,"nb-card-footer",27),r.dc(17,"button",28),r.kc("click",(function(){return r.Dc(e),r.mc().cancelMulEdit()})),r.Oc(18,"H\u1ee7y"),r.cc(),r.dc(19,"button",29),r.kc("click",(function(){return r.Dc(e),r.mc().mulEditSubmit()})),r.Oc(20,"L\u01b0u"),r.cc(),r.cc(),r.cc(),r.cc()}if(2&e){const e=r.mc();r.Lb(6),r.sc("ngModel",e.mulEditEntity.isView),r.Lb(2),r.sc("ngModel",e.mulEditEntity.isCreate),r.Lb(2),r.sc("ngModel",e.mulEditEntity.isEdit),r.Lb(2),r.sc("ngModel",e.mulEditEntity.isDelete),r.Lb(3),r.sc("ngModel",e.mulEditEntity.definition)}}function H(e,t){if(1&e){const e=r.ec();r.dc(0,"input",30),r.kc("ngModelChange",(function(c){return r.Dc(e),t.row[t.column.prop]=c}))("change",(function(){r.Dc(e);const c=t.column,n=t.row;return r.mc().updateCellValue(c.prop,n)})),r.cc()}2&e&&r.sc("ngModel",t.row[t.column.prop])}function J(e,t){if(1&e){const e=r.ec();r.dc(0,"input",30),r.kc("ngModelChange",(function(c){return r.Dc(e),t.row[t.column.prop]=c}))("change",(function(){r.Dc(e);const c=t.column,n=t.row;return r.mc().updateCellValue(c.prop,n)})),r.cc()}2&e&&r.sc("ngModel",t.row[t.column.prop])}function Q(e,t){if(1&e){const e=r.ec();r.dc(0,"input",30),r.kc("ngModelChange",(function(c){return r.Dc(e),t.row[t.column.prop]=c}))("change",(function(){r.Dc(e);const c=t.column,n=t.row;return r.mc().updateCellValue(c.prop,n)})),r.cc()}2&e&&r.sc("ngModel",t.row[t.column.prop])}function W(e,t){if(1&e){const e=r.ec();r.dc(0,"input",30),r.kc("ngModelChange",(function(c){return r.Dc(e),t.row[t.column.prop]=c}))("change",(function(){r.Dc(e);const c=t.column,n=t.row;return r.mc().updateCellValue(c.prop,n)})),r.cc()}2&e&&r.sc("ngModel",t.row[t.column.prop])}function Y(e,t){if(1&e){const e=r.ec();r.dc(0,"nb-checkbox",31),r.kc("ngModelChange",(function(c){return r.Dc(e),t.row[t.column.prop]=c}))("ngModelChange",(function(){r.Dc(e);const c=t.column,n=t.row;return r.mc().updateCellValue(c.prop,n)})),r.cc()}2&e&&r.sc("ngModel",t.row[t.column.prop])}let K=(()=>{class e{constructor(e,t,c,n,i){this.layerService=e,this.datasetService=t,this.roleLayerService=c,this.toast=n,this.roleService=i,this.ColumnMode=a.a,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1,hasScroll:!0},this.lstDatasetId=[],this.configSelDts={service:this.datasetService,fieldName:"datasetName",fieldValue:"datasetId"},this.bulks=[{name:"edit",title:"Ch\u1ec9nh s\u1eeda"}],this.isSync=!1,this.tblItemSelected=[],this.mulEditEntity=null,this.isMulEditingReq=!1}ngOnInit(){this.datatableService={service:this.roleLayerService,primaryField:"id",builder:this.getBuilder.bind(this)}}getBuilder(e){e.select(["roleId","isView","isCreate","isDelete","isEdit","definition","outFields","queryFields","updateFields"]),e.setJoin([{field:"layer",select:["layerName","datasetId"]}]),e.setFilter([{field:"roleId",operator:"$eq",value:this.roleId},{field:"layer.datasetId",operator:"$in",value:this.lstDatasetId}])}selectedItem(e){this.tblItemSelected=e.selected}bulkClick(e){"delete"===e.action.name||"edit"===e.action.name&&(this.mulEditEntity={isEdit:!0,isCreate:!0,isDelete:!0,isView:!0,outFields:null,queryFields:null,updateFields:null})}get isMulEdit(){return Boolean(this.mulEditEntity)}mulEditSubmit(){this.tblItemSelected&&this.mulEditEntity&&(this.isMulEditingReq=!0,this.subcriberMulEdit=Object(s.a)(this.tblItemSelected.map(e=>this.roleLayerService.patch(e.id,this.mulEditEntity))).pipe(Object(d.a)(()=>{this.isMulEditingReq=!1,delete this.subcriberMulEdit,delete this.mulEditEntity})).subscribe(e=>{this.toast.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng","Th\xe0nh c\xf4ng"),this.table.loadData()},e=>{this.toast.danger(e&&e.message,"L\u1ed7i")}))}cancelMulEdit(){this.subcriberMulEdit&&this.subcriberMulEdit.unsubscribe(),delete this.subcriberMulEdit,this.mulEditEntity=null,this.isMulEditingReq=!1}sync(){this.roleId&&(this.lstDatasetId?(this.isSync=!0,this.roleService.syncLayers({roleId:this.roleId,lstDatasetId:this.lstDatasetId}).pipe(Object(d.a)(()=>this.isSync=!1)).subscribe(e=>{this.toast.success("\u0110\u1ed3ng b\u1ed9 th\xe0nh c\xf4ng "+e.length,"Th\xe0nh c\xf4ng"),this.table.loadData()},e=>this.toast.danger(e||"C\xf3 l\u1ed7i x\u1ea3y ra"))):this.toast.warning("Vui l\xf2ng ch\u1ecdn dataset","Th\xf4ng b\xe1o"))}updateCellValue(e,t){this.roleLayerService.patch(t.id,{[e]:t[e]}).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(X.a),r.Xb(V.a),r.Xb(l.a),r.Xb(h.qb),r.Xb(l.b))},e.\u0275cmp=r.Rb({type:e,selectors:[["ga-layer"]],viewQuery:function(e,t){var c;1&e&&r.Sc(F,!0),2&e&&r.zc(c=r.lc())&&(t.table=c.first)},inputs:{roleId:"roleId"},decls:33,vars:25,consts:[[1,"row"],[1,"col-md-12"],["fullWidth","","placeholder","Dataset",1,"w-100",3,"multiple","config","value","valueChange"],["selectDts",""],[1,"col-md-12","d-flex","justify-content-end","mt-2"],["nbButton","","size","small","outline","","ghost","","status","danger",3,"click"],["nbButton","","size","small","outline","","ghost","",3,"click"],["nbButton","","size","small","outline","",3,"click"],["nbButton","","outline","","status","danger","nbTooltip","T\u1ea3i l\u1edbp d\u1eef li\u1ec7u t\u1eeb h\u1ec7 th\u1ed1ng \u0111\u1ec3 c\u1ea5p quy\u1ec1n truy c\u1eadp",3,"disabled","nbSpinner","click"],[4,"ngIf"],["selectionType","checkbox",1,"material","striped",3,"externalPaging","limit","datatableService","columnMode","bulkActions","selected","bulkClick","select"],["table",""],["name","T\xean","prop","layer.layerName",3,"flexGrow"],["name","Xem","prop","isView",3,"flexGrow","cellTemplate"],["name","T\u1ea1o","prop","isCreate",3,"flexGrow","cellTemplate"],["name","X\xf3a","prop","isDelete",3,"flexGrow","cellTemplate"],["name","S\u1eeda","prop","isEdit",3,"flexGrow","cellTemplate"],["name","L\u1ec7nh truy v\u1ea5n","prop","definition",3,"flexGrow"],["ngn-datatable-cell-template",""],["name","Thu\u1ed9c t\xednh hi\u1ec3n th\u1ecb","prop","outFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh t\xecm ki\u1ebfm","prop","queryFields",3,"flexGrow"],["name","Thu\u1ed9c t\xednh c\u1eadp nh\u1eadt","prop","updateFields",3,"flexGrow"],["tplCellStatus",""],[1,"mt-2"],[1,"row","col-md-12"],[1,"form-input",3,"ngModel","ngModelChange"],["type","text","nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["nbButton","","size","small","ghost","",3,"click"],["nbButton","","size","small",3,"click"],["nbInput","","fieldSize","small","fullWidth","",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e){const e=r.ec();r.dc(0,"div",0),r.dc(1,"div",1),r.dc(2,"ga-select",2,3),r.kc("valueChange",(function(e){return t.lstDatasetId=e})),r.cc(),r.cc(),r.dc(4,"div",4),r.dc(5,"button",5),r.kc("click",(function(){return t.lstDatasetId=[]})),r.Oc(6,"H\u1ee7y ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),r.cc(),r.dc(7,"button",6),r.kc("click",(function(){return r.Dc(e),r.Ac(3).selectAll()})),r.Oc(8,"Ch\u1ecdn t\u1ea5t c\u1ea3 dataset"),r.cc(),r.dc(9,"button",7),r.kc("click",(function(){return r.Dc(e),r.Ac(17).loadData()})),r.Oc(10,"L\u1ecdc"),r.cc(),r.cc(),r.dc(11,"div",1),r.dc(12,"div"),r.dc(13,"button",8),r.kc("click",(function(){return t.sync()})),r.Oc(14," \u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u "),r.cc(),r.cc(),r.Mc(15,j,21,5,"div",9),r.dc(16,"ngn-datatable",10,11),r.kc("bulkClick",(function(e){return t.bulkClick(e)}))("select",(function(e){return t.selectedItem(e)})),r.Yb(18,"ngn-datatable-column",12),r.Yb(19,"ngn-datatable-column",13),r.Yb(20,"ngn-datatable-column",14),r.Yb(21,"ngn-datatable-column",15),r.Yb(22,"ngn-datatable-column",16),r.dc(23,"ngn-datatable-column",17),r.Mc(24,H,1,1,"ng-template",18),r.cc(),r.dc(25,"ngn-datatable-column",19),r.Mc(26,J,1,1,"ng-template",18),r.cc(),r.dc(27,"ngn-datatable-column",20),r.Mc(28,Q,1,1,"ng-template",18),r.cc(),r.dc(29,"ngn-datatable-column",21),r.Mc(30,W,1,1,"ng-template",18),r.cc(),r.cc(),r.cc(),r.cc(),r.Mc(31,Y,1,1,"ng-template",null,22,r.Nc)}if(2&e){const e=r.Ac(32);r.Lb(2),r.sc("multiple",!0)("config",t.configSelDts)("value",t.lstDatasetId),r.Lb(11),r.sc("disabled",0===t.lstDatasetId.length||t.isSync)("nbSpinner",t.isSync),r.Lb(2),r.sc("ngIf",t.isMulEdit),r.Lb(1),r.sc("externalPaging",!0)("limit",255)("datatableService",t.datatableService)("columnMode",t.ColumnMode.flex)("bulkActions",t.bulks)("selected",t.tblItemSelected),r.Lb(2),r.sc("flexGrow",2),r.Lb(1),r.sc("flexGrow",1)("cellTemplate",e),r.Lb(1),r.sc("flexGrow",1)("cellTemplate",e),r.Lb(1),r.sc("flexGrow",1)("cellTemplate",e),r.Lb(1),r.sc("flexGrow",1)("cellTemplate",e),r.Lb(1),r.sc("flexGrow",2),r.Lb(2),r.sc("flexGrow",4),r.Lb(2),r.sc("flexGrow",4),r.Lb(2),r.sc("flexGrow",4)}},directives:[g.a,h.o,h.rb,h.kb,n.u,a.d,a.c,a.b,h.r,h.t,h.q,h.v,b.j,b.m,h.G,b.b,h.s],styles:[""]}),e})();const $=["dlg"];let U=(()=>{class e{constructor(e,t){this.router=e,this.route=t,this.userConfig={closeOnBackdropClick:!1,closeOnEsc:!1}}ngOnInit(){this.roleId=this.route.snapshot.paramMap.get("roleId")}exit(){this.router.navigate(["../.."],{relativeTo:this.route})}ngOnDestroy(){this.dlg.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Xb(u.c),r.Xb(u.a))},e.\u0275cmp=r.Rb({type:e,selectors:[["ga-role-dlg-app"]],viewQuery:function(e,t){var c;1&e&&r.Jc($,!0),2&e&&r.zc(c=r.lc())&&(t.dlg=c.first)},decls:9,vars:4,consts:[[3,"open","userConfig","width"],["dlg",""],[1,"w-100",3,"roleId"],["nbButton","","size","small","ghost","",3,"click"]],template:function(e,t){if(1&e){const e=r.ec();r.dc(0,"core-dialog",0,1),r.dc(2,"core-dialog-header"),r.Oc(3,"L\u1edbp d\u1eef li\u1ec7u"),r.cc(),r.dc(4,"core-dialog-body"),r.Yb(5,"ga-layer",2),r.cc(),r.dc(6,"core-dialog-footer"),r.dc(7,"button",3),r.kc("click",(function(){return r.Dc(e),r.Ac(1).close(),t.exit()})),r.Oc(8,"\u0110\xf3ng"),r.cc(),r.cc(),r.cc()}2&e&&(r.sc("open",!0)("userConfig",t.userConfig)("width","100vw"),r.Lb(5),r.sc("roleId",t.roleId))},directives:[A.b,A.d,A.a,K,A.c,h.o],encapsulation:2}),e})(),_=(()=>{class e{}return e.\u0275mod=r.Vb({type:e}),e.\u0275inj=r.Ub({factory:function(t){return new(t||e)},imports:[[n.c,h.f,h.B,h.u,h.H,h.k,h.p,R.a,b.g,h.gb,N.a,h.lb,x.a,h.w,T.a,P.a,h.cb,q.a,a.e,u.g.forChild([{path:"",component:O,children:[{path:":roleId/application",component:z},{path:":roleId/layer",component:U}]}])]]}),e})()}}]);